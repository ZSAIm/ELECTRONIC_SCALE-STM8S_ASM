STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 1  Assembler
                                               e:\stm8s\electronic_scale\key.asm

   1                         stm8/     
   2                         
   3                         
   0  000000                                 #include "stm8s105k4.inc"
   1                         ; STM8S105K4.inc
   2  000000 U                               #IFDEF   __INCLUDE_STM8S105K4_
   4  000000                                 #define  __INCLUDE_STM8S105K4_ 1
   0  000000                                 #include "STM8S105K.inc"
   1                         ; STM8S105K.inc
   2                         
   3                         ; Copyright (c) 2003-2012 STMicroelectronics
   4                         
   5  000000 U                               #ifdef   __STM8S105K__
   8  000000                                 #define  __STM8S105K__ 1
   9                         
  10                         ; STM8S105K
  11                         
  12                         
  13                         ; Port A
  14                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
  15                         
  16  000000                                 EXTERN   PA_ODR.w      ; Port A data output latch 
                                                                ;register
  17                         
  18  000000                                 EXTERN   PA_IDR.w      ; Port A input pin value 
                                                                ;register
  19                         
  20  000000                                 EXTERN   PA_DDR.w      ; Port A data direction 
                                                                ;register
  21                         
  22  000000                                 EXTERN   PA_CR1.w      ; Port A control register 1
  23                         
  24  000000                                 EXTERN   PA_CR2.w      ; Port A control register 2
  25                         
  26                         ; Port B
  27                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
  28                         
  29  000000                                 EXTERN   PB_ODR.w      ; Port B data output latch 
                                                                ;register
  30                         
  31  000000                                 EXTERN   PB_IDR.w      ; Port B input pin value 
                                                                ;register
  32                         
  33  000000                                 EXTERN   PB_DDR.w      ; Port B data direction 
                                                                ;register
  34                         
  35  000000                                 EXTERN   PB_CR1.w      ; Port B control register 1
  36                         
  37  000000                                 EXTERN   PB_CR2.w      ; Port B control register 2
  38                         
  39                         ; Port C
  40                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
  41                         
  42  000000                                 EXTERN   PC_ODR.w      ; Port C data output latch 
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 2  Assembler
                                               e:\stm8s\electronic_scale\key.asm

                                                                ;register
  43                         
  44  000000                                 EXTERN   PC_IDR.w      ; Port C input pin value 
                                                                ;register
  45                         
  46  000000                                 EXTERN   PC_DDR.w      ; Port C data direction 
                                                                ;register
  47                         
  48  000000                                 EXTERN   PC_CR1.w      ; Port C control register 1
  49                         
  50  000000                                 EXTERN   PC_CR2.w      ; Port C control register 2
  51                         
  52                         ; Port D
  53                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
  54                         
  55  000000                                 EXTERN   PD_ODR.w      ; Port D data output latch 
                                                                ;register
  56                         
  57  000000                                 EXTERN   PD_IDR.w      ; Port D input pin value 
                                                                ;register
  58                         
  59  000000                                 EXTERN   PD_DDR.w      ; Port D data direction 
                                                                ;register
  60                         
  61  000000                                 EXTERN   PD_CR1.w      ; Port D control register 1
  62                         
  63  000000                                 EXTERN   PD_CR2.w      ; Port D control register 2
  64                         
  65                         ; Port E
  66                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
  67                         
  68  000000                                 EXTERN   PE_ODR.w      ; Port E data output latch 
                                                                ;register
  69                         
  70  000000                                 EXTERN   PE_IDR.w      ; Port E input pin value 
                                                                ;register
  71                         
  72  000000                                 EXTERN   PE_DDR.w      ; Port E data direction 
                                                                ;register
  73                         
  74  000000                                 EXTERN   PE_CR1.w      ; Port E control register 1
  75                         
  76  000000                                 EXTERN   PE_CR2.w      ; Port E control register 2
  77                         
  78                         ; Port F
  79                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
  80                         
  81  000000                                 EXTERN   PF_ODR.w      ; Port F data output latch 
                                                                ;register
  82                         
  83  000000                                 EXTERN   PF_IDR.w      ; Port F input pin value 
                                                                ;register
  84                         
  85  000000                                 EXTERN   PF_DDR.w      ; Port F data direction 
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 3  Assembler
                                               e:\stm8s\electronic_scale\key.asm

                                                                ;register
  86                         
  87  000000                                 EXTERN   PF_CR1.w      ; Port F control register 1
  88                         
  89  000000                                 EXTERN   PF_CR2.w      ; Port F control register 2
  90                         
  91                         ; Flash
  92                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
  93                         
  94  000000                                 EXTERN   FLASH_CR1.w   ; Flash control register 1
  95                         
  96  000000                                 EXTERN   FLASH_CR2.w   ; Flash control register 2
  97                         
  98  000000                                 EXTERN   FLASH_NCR2.w  ; Flash complementary control 
                                                                ;register 2
  99                         
 100  000000                                 EXTERN   FLASH_FPR.w   ; Flash protection register
 101                         
 102  000000                                 EXTERN   FLASH_NFPR.w  ; Flash complementary protection
                                                                ; register
 103                         
 104  000000                                 EXTERN   FLASH_IAPSR.w  ; Flash in-application 
                                                                ;programming status register
 105                         
 106  000000                                 EXTERN   FLASH_PUKR.w  ; Flash Program memory 
                                                                ;unprotection register
 107                         
 108  000000                                 EXTERN   FLASH_DUKR.w  ; Data EEPROM unprotection 
                                                                ;register
 109                         
 110                         ; External Interrupt Control Register (ITC)
 111                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 112                         
 113  000000                                 EXTERN   EXTI_CR1.w    ; External interrupt control 
                                                                ;register 1
 114                         
 115  000000                                 EXTERN   EXTI_CR2.w    ; External interrupt control 
                                                                ;register 2
 116                         
 117                         ; Reset (RST)
 118                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 119                         
 120  000000                                 EXTERN   RST_SR.w      ; Reset status register 1
 121                         
 122                         ; Clock Control (CLK)
 123                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 124                         
 125  000000                                 EXTERN   CLK_ICKR.w    ; Internal clock control 
                                                                ;register
 126                         
 127  000000                                 EXTERN   CLK_ECKR.w    ; External clock control 
                                                                ;register
 128                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 4  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 129  000000                                 EXTERN   CLK_CMSR.w    ; Clock master status register
 130                         
 131  000000                                 EXTERN   CLK_SWR.w     ; Clock master switch register
 132                         
 133  000000                                 EXTERN   CLK_SWCR.w    ; Clock switch control register
 134                         
 135  000000                                 EXTERN   CLK_CKDIVR.w  ; Clock divider register
 136                         
 137  000000                                 EXTERN   CLK_PCKENR1.w  ; Peripheral clock gating 
                                                                ;register 1
 138                         
 139  000000                                 EXTERN   CLK_CSSR.w    ; Clock security system 
                                                                ;register
 140                         
 141  000000                                 EXTERN   CLK_CCOR.w    ; Configurable clock control 
                                                                ;register
 142                         
 143  000000                                 EXTERN   CLK_PCKENR2.w  ; Peripheral clock gating 
                                                                ;register 2
 144                         
 145  000000                                 EXTERN   CLK_CANCCR.w  ; CAN clock control register
 146                         
 147  000000                                 EXTERN   CLK_HSITRIMR.w  ; HSI clock calibration trimming
                                                                ; register
 148                         
 149  000000                                 EXTERN   CLK_SWIMCCR.w  ; SWIM clock control register
 150                         
 151                         ; Window Watchdog (WWDG)
 152                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 153                         
 154  000000                                 EXTERN   WWDG_CR.w     ; WWDG Control Register
 155                         
 156  000000                                 EXTERN   WWDG_WR.w     ; WWDR Window Register
 157                         
 158                         ; Independent Watchdog (IWDG)
 159                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 160                         
 161  000000                                 EXTERN   IWDG_KR.w     ; IWDG Key Register
 162                         
 163  000000                                 EXTERN   IWDG_PR.w     ; IWDG Prescaler Register
 164                         
 165  000000                                 EXTERN   IWDG_RLR.w    ; IWDG Reload Register
 166                         
 167                         ; Auto Wake-Up (AWU)
 168                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 169                         
 170  000000                                 EXTERN   AWU_CSR.w     ; AWU Control/Status Register
 171                         
 172  000000                                 EXTERN   AWU_APR.w     ; AWU asynchronous prescaler 
                                                                ;buffer register
 173                         
 174  000000                                 EXTERN   AWU_TBR.w     ; AWU Timebase selection 
                                                                ;register
 175                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 5  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 176                         ; Beeper (BEEP)
 177                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 178                         
 179  000000                                 EXTERN   BEEP_CSR.w    ; BEEP Control/Status Register
 180                         
 181                         ; Serial Peripheral Interface (SPI)
 182                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 183                         
 184  000000                                 EXTERN   SPI_CR1.w     ; SPI Control Register 1
 185                         
 186  000000                                 EXTERN   SPI_CR2.w     ; SPI Control Register 2
 187                         
 188  000000                                 EXTERN   SPI_ICR.w     ; SPI Interrupt Control 
                                                                ;Register
 189                         
 190  000000                                 EXTERN   SPI_SR.w      ; SPI Status Register
 191                         
 192  000000                                 EXTERN   SPI_DR.w      ; SPI Data Register
 193                         
 194  000000                                 EXTERN   SPI_CRCPR.w   ; SPI CRC Polynomial Register
 195                         
 196  000000                                 EXTERN   SPI_RXCRCR.w  ; SPI Rx CRC Register
 197                         
 198  000000                                 EXTERN   SPI_TXCRCR.w  ; SPI Tx CRC Register
 199                         
 200                         ; I2C Bus Interface (I2C)
 201                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 202                         
 203  000000                                 EXTERN   I2C_CR1.w     ; I2C control register 1
 204                         
 205  000000                                 EXTERN   I2C_CR2.w     ; I2C control register 2
 206                         
 207  000000                                 EXTERN   I2C_FREQR.w   ; I2C frequency register
 208                         
 209  000000                                 EXTERN   I2C_OARL.w    ; I2C Own address register low
 210                         
 211  000000                                 EXTERN   I2C_OARH.w    ; I2C Own address register high
 212                         
 213  000000                                 EXTERN   I2C_DR.w      ; I2C data register
 214                         
 215  000000                                 EXTERN   I2C_SR1.w     ; I2C status register 1
 216                         
 217  000000                                 EXTERN   I2C_SR2.w     ; I2C status register 2
 218                         
 219  000000                                 EXTERN   I2C_SR3.w     ; I2C status register 3
 220                         
 221  000000                                 EXTERN   I2C_ITR.w     ; I2C interrupt control 
                                                                ;register
 222                         
 223  000000                                 EXTERN   I2C_CCRL.w    ; I2C Clock control register 
                                                                ;low
 224                         
 225  000000                                 EXTERN   I2C_CCRH.w    ; I2C Clock control register 
                                                                ;high
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 6  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 226                         
 227  000000                                 EXTERN   I2C_TRISER.w  ; I2C TRISE register
 228                         
 229  000000                                 EXTERN   I2C_PECR.w    ; I2C packet error checking 
                                                                ;register
 230                         
 231                         ; LIN Universal asynch. receiver transmitter (UART2)
 232                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 233                         
 234  000000                                 EXTERN   UART2_SR.w    ; UART2 Status Register
 235                         
 236  000000                                 EXTERN   UART2_DR.w    ; UART2 Data Register
 237                         
 238  000000                                 EXTERN   UART2_BRR1.w  ; UART2 Baud Rate Register 1
 239                         
 240  000000                                 EXTERN   UART2_BRR2.w  ; UART2 Baud Rate Register 2
 241                         
 242  000000                                 EXTERN   UART2_CR1.w   ; UART2 Control Register 1
 243                         
 244  000000                                 EXTERN   UART2_CR2.w   ; UART2 Control Register 2
 245                         
 246  000000                                 EXTERN   UART2_CR3.w   ; UART2 Control Register 3
 247                         
 248  000000                                 EXTERN   UART2_CR4.w   ; UART2 Control Register 4
 249                         
 250  000000                                 EXTERN   UART2_CR5.w   ; UART2 Control Register 5
 251                         
 252  000000                                 EXTERN   UART2_CR6.w   ; UART2 Control Register 6
 253                         
 254  000000                                 EXTERN   UART2_GTR.w   ; UART2 Guard time Register
 255                         
 256  000000                                 EXTERN   UART2_PSCR.w  ; UART2 Prescaler Register
 257                         
 258                         ; 16-Bit Timer 1 (TIM1)
 259                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 260                         
 261  000000                                 EXTERN   TIM1_CR1.w    ; TIM1 Control register 1
 262                         
 263  000000                                 EXTERN   TIM1_CR2.w    ; TIM1 Control register 2
 264                         
 265  000000                                 EXTERN   TIM1_SMCR.w   ; TIM1 Slave Mode Control 
                                                                ;register
 266                         
 267  000000                                 EXTERN   TIM1_ETR.w    ; TIM1 external trigger 
                                                                ;register
 268                         
 269  000000                                 EXTERN   TIM1_IER.w    ; TIM1 Interrupt enable 
                                                                ;register
 270                         
 271  000000                                 EXTERN   TIM1_SR1.w    ; TIM1 Status register 1
 272                         
 273  000000                                 EXTERN   TIM1_SR2.w    ; TIM1 Status register 2
 274                         
 275  000000                                 EXTERN   TIM1_EGR.w    ; TIM1 Event Generation 
                                                                ;register
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 7  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 276                         
 277  000000                                 EXTERN   TIM1_CCMR1.w  ; TIM1 Capture/Compare mode 
                                                                ;register 1
 278                         
 279  000000                                 EXTERN   TIM1_CCMR2.w  ; TIM1 Capture/Compare mode 
                                                                ;register 2
 280                         
 281  000000                                 EXTERN   TIM1_CCMR3.w  ; TIM1 Capture/Compare mode 
                                                                ;register 3
 282                         
 283  000000                                 EXTERN   TIM1_CCMR4.w  ; TIM1 Capture/Compare mode 
                                                                ;register 4
 284                         
 285  000000                                 EXTERN   TIM1_CCER1.w  ; TIM1 Capture/Compare enable 
                                                                ;register 1
 286                         
 287  000000                                 EXTERN   TIM1_CCER2.w  ; TIM1 Capture/Compare enable 
                                                                ;register 2
 288                         
 289  000000                                 EXTERN   TIM1_CNTRH.w  ; Data bits High
 290                         
 291  000000                                 EXTERN   TIM1_CNTRL.w  ; Data bits Low
 292                         
 293  000000                                 EXTERN   TIM1_PSCRH.w  ; Data bits High
 294                         
 295  000000                                 EXTERN   TIM1_PSCRL.w  ; Data bits Low
 296                         
 297  000000                                 EXTERN   TIM1_ARRH.w   ; Data bits High
 298                         
 299  000000                                 EXTERN   TIM1_ARRL.w   ; Data bits Low
 300                         
 301  000000                                 EXTERN   TIM1_RCR.w    ; TIM1 Repetition counter 
                                                                ;register
 302                         
 303  000000                                 EXTERN   TIM1_CCR1H.w  ; Data bits High
 304                         
 305  000000                                 EXTERN   TIM1_CCR1L.w  ; Data bits Low
 306                         
 307  000000                                 EXTERN   TIM1_CCR2H.w  ; Data bits High
 308                         
 309  000000                                 EXTERN   TIM1_CCR2L.w  ; Data bits Low
 310                         
 311  000000                                 EXTERN   TIM1_CCR3H.w  ; Data bits High
 312                         
 313  000000                                 EXTERN   TIM1_CCR3L.w  ; Data bits Low
 314                         
 315  000000                                 EXTERN   TIM1_CCR4H.w  ; Data bits High
 316                         
 317  000000                                 EXTERN   TIM1_CCR4L.w  ; Data bits Low
 318                         
 319  000000                                 EXTERN   TIM1_BKR.w    ; TIM1 Break register
 320                         
 321  000000                                 EXTERN   TIM1_DTR.w    ; TIM1 Dead-time register
 322                         
 323  000000                                 EXTERN   TIM1_OISR.w   ; TIM1 Output idle state 
                                                                ;register
 324                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 8  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 325                         ; 16-Bit Timer 2 (TIM2)
 326                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 327                         
 328  000000                                 EXTERN   TIM2_CR1.w    ; TIM2 Control register 1
 329                         
 330  000000                                 EXTERN   TIM2_IER.w    ; TIM2 Interrupt enable 
                                                                ;register
 331                         
 332  000000                                 EXTERN   TIM2_SR1.w    ; TIM2 Status register 1
 333                         
 334  000000                                 EXTERN   TIM2_SR2.w    ; TIM2 Status register 2
 335                         
 336  000000                                 EXTERN   TIM2_EGR.w    ; TIM2 Event Generation 
                                                                ;register
 337                         
 338  000000                                 EXTERN   TIM2_CCMR1.w  ; TIM2 Capture/Compare mode 
                                                                ;register 1
 339                         
 340  000000                                 EXTERN   TIM2_CCMR2.w  ; TIM2 Capture/Compare mode 
                                                                ;register 2
 341                         
 342  000000                                 EXTERN   TIM2_CCMR3.w  ; TIM2 Capture/Compare mode 
                                                                ;register 3
 343                         
 344  000000                                 EXTERN   TIM2_CCER1.w  ; TIM2 Capture/Compare enable 
                                                                ;register 1
 345                         
 346  000000                                 EXTERN   TIM2_CCER2.w  ; TIM2 Capture/Compare enable 
                                                                ;register 2
 347                         
 348  000000                                 EXTERN   TIM2_CNTRH.w  ; Data bits High
 349                         
 350  000000                                 EXTERN   TIM2_CNTRL.w  ; Data bits Low
 351                         
 352  000000                                 EXTERN   TIM2_PSCR.w   ; TIM2 Prescaler register
 353                         
 354  000000                                 EXTERN   TIM2_ARRH.w   ; Data bits High
 355                         
 356  000000                                 EXTERN   TIM2_ARRL.w   ; Data bits Low
 357                         
 358  000000                                 EXTERN   TIM2_CCR1H.w  ; Data bits High
 359                         
 360  000000                                 EXTERN   TIM2_CCR1L.w  ; Data bits Low
 361                         
 362  000000                                 EXTERN   TIM2_CCR2H.w  ; Data bits High
 363                         
 364  000000                                 EXTERN   TIM2_CCR2L.w  ; Data bits Low
 365                         
 366  000000                                 EXTERN   TIM2_CCR3H.w  ; Data bits High
 367                         
 368  000000                                 EXTERN   TIM2_CCR3L.w  ; Data bits Low
 369                         
 370                         ; 16-Bit Timer 3 (TIM3)
 371                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 372                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 9  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 373  000000                                 EXTERN   TIM3_CR1.w    ; TIM3 Control register 1
 374                         
 375  000000                                 EXTERN   TIM3_IER.w    ; TIM3 Interrupt enable 
                                                                ;register
 376                         
 377  000000                                 EXTERN   TIM3_SR1.w    ; TIM3 Status register 1
 378                         
 379  000000                                 EXTERN   TIM3_SR2.w    ; TIM3 Status register 2
 380                         
 381  000000                                 EXTERN   TIM3_EGR.w    ; TIM3 Event Generation 
                                                                ;register
 382                         
 383  000000                                 EXTERN   TIM3_CCMR1.w  ; TIM3 Capture/Compare mode 
                                                                ;register 1
 384                         
 385  000000                                 EXTERN   TIM3_CCMR2.w  ; TIM3 Capture/Compare mode 
                                                                ;register 2
 386                         
 387  000000                                 EXTERN   TIM3_CCER1.w  ; TIM3 Capture/Compare enable 
                                                                ;register 1
 388                         
 389  000000                                 EXTERN   TIM3_CNTRH.w  ; Data bits High
 390                         
 391  000000                                 EXTERN   TIM3_CNTRL.w  ; Data bits Low
 392                         
 393  000000                                 EXTERN   TIM3_PSCR.w   ; TIM3 Prescaler register
 394                         
 395  000000                                 EXTERN   TIM3_ARRH.w   ; Data bits High
 396                         
 397  000000                                 EXTERN   TIM3_ARRL.w   ; Data bits Low
 398                         
 399  000000                                 EXTERN   TIM3_CCR1H.w  ; Data bits High
 400                         
 401  000000                                 EXTERN   TIM3_CCR1L.w  ; Data bits Low
 402                         
 403  000000                                 EXTERN   TIM3_CCR2H.w  ; Data bits High
 404                         
 405  000000                                 EXTERN   TIM3_CCR2L.w  ; Data bits Low
 406                         
 407                         ; 8-Bit  Timer 4 (TIM4)
 408                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 409                         
 410  000000                                 EXTERN   TIM4_CR1.w    ; TIM4 Control register 1
 411                         
 412  000000                                 EXTERN   TIM4_IER.w    ; TIM4 Interrupt enable 
                                                                ;register
 413                         
 414  000000                                 EXTERN   TIM4_SR.w     ; TIM4 Status register
 415                         
 416  000000                                 EXTERN   TIM4_EGR.w    ; TIM4 Event Generation 
                                                                ;register
 417                         
 418  000000                                 EXTERN   TIM4_CNTR.w   ; TIM4 Counter
 419                         
 420  000000                                 EXTERN   TIM4_PSCR.w   ; TIM4 Prescaler register
 421                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 10  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 422  000000                                 EXTERN   TIM4_ARR.w    ; TIM4 Auto-reload register
 423                         
 424                         ; 10-Bit A/D Converter (ADC1)
 425                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 426                         
 427  000000                                 EXTERN   ADC_DB0RH.w   ; Data Buffer register 0 High
 428                         
 429  000000                                 EXTERN   ADC_DB0RL.w   ; Data Buffer register 0 Low
 430                         
 431  000000                                 EXTERN   ADC_DB1RH.w   ; Data Buffer register 1 High
 432                         
 433  000000                                 EXTERN   ADC_DB1RL.w   ; Data Buffer register 1 Low
 434                         
 435  000000                                 EXTERN   ADC_DB2RH.w   ; Data Buffer register 2 High
 436                         
 437  000000                                 EXTERN   ADC_DB2RL.w   ; Data Buffer register 2 Low
 438                         
 439  000000                                 EXTERN   ADC_DB3RH.w   ; Data Buffer register 3 High
 440                         
 441  000000                                 EXTERN   ADC_DB3RL.w   ; Data Buffer register 3 Low
 442                         
 443  000000                                 EXTERN   ADC_DB4RH.w   ; Data Buffer register 4 High
 444                         
 445  000000                                 EXTERN   ADC_DB4RL.w   ; Data Buffer register 4 Low
 446                         
 447  000000                                 EXTERN   ADC_DB5RH.w   ; Data Buffer register 5 High
 448                         
 449  000000                                 EXTERN   ADC_DB5RL.w   ; Data Buffer register 5 Low
 450                         
 451  000000                                 EXTERN   ADC_DB6RH.w   ; Data Buffer register 6 High
 452                         
 453  000000                                 EXTERN   ADC_DB6RL.w   ; Data Buffer register 6 Low
 454                         
 455  000000                                 EXTERN   ADC_DB7RH.w   ; Data Buffer register 7 High
 456                         
 457  000000                                 EXTERN   ADC_DB7RL.w   ; Data Buffer register 7 Low
 458                         
 459  000000                                 EXTERN   ADC_DB8RH.w   ; Data Buffer register 8 High
 460                         
 461  000000                                 EXTERN   ADC_DB8RL.w   ; Data Buffer register 8 Low
 462                         
 463  000000                                 EXTERN   ADC_DB9RH.w   ; Data Buffer register 9 High
 464                         
 465  000000                                 EXTERN   ADC_DB9RL.w   ; Data Buffer register 9 Low
 466                         
 467  000000                                 EXTERN   ADC_CSR.w     ; ADC Control/Status Register
 468                         
 469  000000                                 EXTERN   ADC_CR1.w     ; ADC Configuration Register 1
 470                         
 471  000000                                 EXTERN   ADC_CR2.w     ; ADC Configuration Register 2
 472                         
 473  000000                                 EXTERN   ADC_CR3.w     ; ADC Configuration Register 3
 474                         
 475  000000                                 EXTERN   ADC_DRH.w     ; Data bits High
 476                         
 477  000000                                 EXTERN   ADC_DRL.w     ; Data bits Low
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 11  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 478                         
 479  000000                                 EXTERN   ADC_TDRH.w    ; Schmitt trigger disable High
 480                         
 481  000000                                 EXTERN   ADC_TDRL.w    ; Schmitt trigger disable Low
 482                         
 483  000000                                 EXTERN   ADC_HTRH.w    ; High Threshold Register High
 484                         
 485  000000                                 EXTERN   ADC_HTRL.w    ; High Threshold Register Low
 486                         
 487  000000                                 EXTERN   ADC_LTRH.w    ; Low Threshold Register High
 488                         
 489  000000                                 EXTERN   ADC_LTRL.w    ; Low Threshold Register Low
 490                         
 491  000000                                 EXTERN   ADC_AWSRH.w   ; Analog Watchdog Status 
                                                                ;register High
 492                         
 493  000000                                 EXTERN   ADC_AWSRL.w   ; Analog Watchdog Status 
                                                                ;register Low
 494                         
 495  000000                                 EXTERN   ADC_AWCRH.w   ; Analog Watchdog Control 
                                                                ;register High
 496                         
 497  000000                                 EXTERN   ADC_AWCRL.w   ; Analog Watchdog Control 
                                                                ;register Low
 498                         
 499                         ;  Global configuration register (CFG)
 500                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 501                         
 502  000000                                 EXTERN   CFG_GCR.w     ; CFG Global configuration 
                                                                ;register
 503                         
 504                         ; Interrupt Software Priority Register (ITC)
 505                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                               ;;;;;;
 506                         
 507  000000                                 EXTERN   ITC_SPR1.w    ; Interrupt Software priority 
                                                                ;register 1
 508                         
 509  000000                                 EXTERN   ITC_SPR2.w    ; Interrupt Software priority 
                                                                ;register 2
 510                         
 511  000000                                 EXTERN   ITC_SPR3.w    ; Interrupt Software priority 
                                                                ;register 3
 512                         
 513  000000                                 EXTERN   ITC_SPR4.w    ; Interrupt Software priority 
                                                                ;register 4
 514                         
 515  000000                                 EXTERN   ITC_SPR5.w    ; Interrupt Software priority 
                                                                ;register 5
 516                         
 517  000000                                 EXTERN   ITC_SPR6.w    ; Interrupt Software priority 
                                                                ;register 6
 518                         
 519  000000                                 EXTERN   ITC_SPR7.w    ; Interrupt Software priority 
                                                                ;register 7
 520                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 12  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 521  000000                                 #endif                 ; __STM8S105K__
<END_OF_INCLUSION>
   6                                   
   7  000000                                 #ENDIF   
   8                         
   9                         
<END_OF_INCLUSION>
   0  000000                                 #include "MacroFunction.inc"
   1                         
   2                                   
   3                                   
   4  000000 U                               #IFDEF   __MACRO_FUNCTION_
   7  000000                                 #define  __MACRO_FUNCTION_ 1
   8                                   
   0  000000                                 #include "LCD.inc"
   1                                   
   2  000000 U                               #IFDEF   __LCD_ 1
   5  000000                                 #define  __LCD_ 1
   6                                   
   0  000000                                 #include "stm8s105k4.inc"
   1                         ; STM8S105K4.inc
   2  000000                                 #IFDEF   1
   3  000000                                 #ELSE    
   8                         
   9                         
<END_OF_INCLUSION>
   0  000000                                 #include "GlobalVar.inc"
   1                         
   2  000000 U                               #IFDEF   __GLOBAL_VAR__
   5                                   
   6  000000                                 #define  __GLOBAL_VAR__ 1
   7                         ;   ++ 0x0F
   8  000000                                 EXTERN   LCD_VAR0.B
   9  000000                                 EXTERN   LCD_VAR1.B
  10  000000                                 EXTERN   LCD_VAR2.B
  11                                   
  12  000000                                 EXTERN   ADC_COUNTER.B
  13                         
  14                                   
  15                         ;   ++ 0x04
  16  000000                                 EXTERN   ADC_SUM.B
  17  000000                                 EXTERN   ADC_SUM0.B
  18  000000                                 EXTERN   ADC_SUM1.B
  19  000000                                 EXTERN   ADC_SUM2.B
  20  000000                                 EXTERN   ADC_SUM3.B
  21                         ;   ++ 0x04
  22  000000                                 EXTERN   ADC_AVG.B
  23  000000                                 EXTERN   ADC_AVG0.B
  24  000000                                 EXTERN   ADC_AVG1.B
  25  000000                                 EXTERN   ADC_AVG2.B
  26  000000                                 EXTERN   ADC_AVG3.B
  27                         ;   ++ 0x18
  28  000000                                 EXTERN   ADC_STORE.B
  29                         
  30  000000                                 EXTERN   ADC_S00.B 
  31  000000                                 EXTERN   ADC_S01.B
  32  000000                                 EXTERN   ADC_S02.B
  33                                   
  34  000000                                 EXTERN   ADC_S10.B
  35  000000                                 EXTERN   ADC_S11.B
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 13  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  36  000000                                 EXTERN   ADC_S12.B
  37                         
  38  000000                                 EXTERN   ADC_S20.B
  39  000000                                 EXTERN   ADC_S21.B
  40  000000                                 EXTERN   ADC_S22.B
  41                                   
  42  000000                                 EXTERN   ADC_S30.B
  43  000000                                 EXTERN   ADC_S31.B
  44  000000                                 EXTERN   ADC_S32.B
  45                                   
  46  000000                                 EXTERN   ADC_S40.B
  47  000000                                 EXTERN   ADC_S41.B
  48  000000                                 EXTERN   ADC_S42.B
  49                                   
  50  000000                                 EXTERN   ADC_S50.B
  51  000000                                 EXTERN   ADC_S51.B
  52  000000                                 EXTERN   ADC_S52.B
  53                                   
  54  000000                                 EXTERN   ADC_S60.B
  55  000000                                 EXTERN   ADC_S61.B
  56  000000                                 EXTERN   ADC_S62.B
  57                                   
  58  000000                                 EXTERN   ADC_S70.B
  59  000000                                 EXTERN   ADC_S71.B
  60  000000                                 EXTERN   ADC_S72.B
  61                         ;   ++ 0x03
  62  000000                                 EXTERN   ADC_S80.B
  63  000000                                 EXTERN   ADC_S81.B
  64  000000                                 EXTERN   ADC_S82.B
  65                                   
  66  000000                                 EXTERN   ADC_S90.B
  67  000000                                 EXTERN   ADC_S91.B
  68  000000                                 EXTERN   ADC_S92.B
  69                                   
  70  000000                                 EXTERN   ADC_SA0.B
  71  000000                                 EXTERN   ADC_SA1.B
  72  000000                                 EXTERN   ADC_SA2.B
  73                                   
  74  000000                                 EXTERN   ADC_SB0.B
  75  000000                                 EXTERN   ADC_SB1.B
  76  000000                                 EXTERN   ADC_SB2.B
  77                                   
  78  000000                                 EXTERN   ADC_SC0.B
  79  000000                                 EXTERN   ADC_SC1.B
  80  000000                                 EXTERN   ADC_SC2.B
  81                                   
  82  000000                                 EXTERN   ADC_SD0.B
  83  000000                                 EXTERN   ADC_SD1.B
  84  000000                                 EXTERN   ADC_SD2.B
  85                                   
  86  000000                                 EXTERN   ADC_SE0.B
  87  000000                                 EXTERN   ADC_SE1.B
  88  000000                                 EXTERN   ADC_SE2.B
  89                                   
  90  000000                                 EXTERN   ADC_SF0.B
  91  000000                                 EXTERN   ADC_SF1.B
  92  000000                                 EXTERN   ADC_SF2.B
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 14  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  93                                   
  94  000000                                 EXTERN   ADC_SG0.B
  95  000000                                 EXTERN   ADC_SG1.B
  96  000000                                 EXTERN   ADC_SG2.B
  97                                   
  98  000000                                 EXTERN   ADC_SH0.B
  99  000000                                 EXTERN   ADC_SH1.B
 100  000000                                 EXTERN   ADC_SH2.B
 101                                   
 102  000000                                 EXTERN   ADC_SI0.B
 103  000000                                 EXTERN   ADC_SI1.B
 104  000000                                 EXTERN   ADC_SI2.B
 105                                   
 106  000000                                 EXTERN   ADC_SJ0.B
 107  000000                                 EXTERN   ADC_SJ1.B
 108  000000                                 EXTERN   ADC_SJ2.B
 109                                   
 110  000000                                 EXTERN   ADC_SK0.B
 111  000000                                 EXTERN   ADC_SK1.B
 112  000000                                 EXTERN   ADC_SK2.B
 113                                   
 114  000000                                 EXTERN   ADC_SL0.B
 115  000000                                 EXTERN   ADC_SL1.B
 116  000000                                 EXTERN   ADC_SL2.B
 117                                   
 118  000000                                 EXTERN   ADC_SM0.B
 119  000000                                 EXTERN   ADC_SM1.B
 120  000000                                 EXTERN   ADC_SM2.B
 121                                   
 122  000000                                 EXTERN   ADC_SN0.B
 123  000000                                 EXTERN   ADC_SN1.B
 124  000000                                 EXTERN   ADC_SN2.B
 125                                   
 126  000000                                 EXTERN   ADC_SO0.B
 127  000000                                 EXTERN   ADC_SO1.B
 128  000000                                 EXTERN   ADC_SO2.B
 129                                   
 130  000000                                 EXTERN   ADC_SP0.B
 131  000000                                 EXTERN   ADC_SP1.B
 132  000000                                 EXTERN   ADC_SP2.B
 133                                   
 134  000000                                 EXTERN   ADC_SQ0.B
 135  000000                                 EXTERN   ADC_SQ1.B
 136  000000                                 EXTERN   ADC_SQ2.B
 137                                   
 138  000000                                 EXTERN   ADC_SR0.B
 139  000000                                 EXTERN   ADC_SR1.B
 140  000000                                 EXTERN   ADC_SR2.B
 141                                   
 142  000000                                 EXTERN   ADC_SS0.B
 143  000000                                 EXTERN   ADC_SS1.B
 144  000000                                 EXTERN   ADC_SS2.B
 145                                   
 146  000000                                 EXTERN   ADC_ST0.B
 147  000000                                 EXTERN   ADC_ST1.B
 148  000000                                 EXTERN   ADC_ST2.B
 149                                   
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 15  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 150  000000                                 EXTERN   ADC_SU0.B
 151  000000                                 EXTERN   ADC_SU1.B
 152  000000                                 EXTERN   ADC_SU2.B
 153                                   
 154  000000                                 EXTERN   ADC_SV0.B
 155  000000                                 EXTERN   ADC_SV1.B
 156  000000                                 EXTERN   ADC_SV2.B
 157                                   
 158  000000                                 EXTERN   ADC_SW0.B
 159  000000                                 EXTERN   ADC_SW1.B
 160  000000                                 EXTERN   ADC_SW2.B
 161                                   
 162  000000                                 EXTERN   ADC_SX0.B
 163  000000                                 EXTERN   ADC_SX1.B
 164  000000                                 EXTERN   ADC_SX2.B
 165                                   
 166  000000                                 EXTERN   ADC_SY0.B
 167  000000                                 EXTERN   ADC_SY1.B
 168  000000                                 EXTERN   ADC_SY2.B
 169                                   
 170  000000                                 EXTERN   ADC_THRESHOLD_QUOTIENT.B
 171  000000                                 EXTERN   ADC_THRESHOLD_QUOTIENT1.B
 172  000000                                 EXTERN   ADC_THRESHOLD_QUOTIENT0.B
 173                         
 174  000000                                 EXTERN   ADC_MAX_QUOTIENT.B
 175  000000                                 EXTERN   ADC_MAX_QUOTIENT_S1.B
 176  000000                                 EXTERN   ADC_MAX_QUOTIENT_S0.B
 177                         
 178  000000                                 EXTERN   ADC_MAX_REMAINDER.B
 179  000000                                 EXTERN   ADC_MAX_REMAINDER_S1.B
 180  000000                                 EXTERN   ADC_MAX_REMAINDER_S0.B
 181                                   
 182                                   
 183                                                          ;EXTERN ADC_SLOPE.B
 184                         ;   ++ 0x01
 185  000000                                 EXTERN   ADC_NEXT_PTR.B
 186                                                          ;EXTERN ADC_MAX_PTR.B
 187                                                          ;EXTERN ADC_MIN_PTR.B
 188                                   
 189                                   
 190  000000                                 EXTERN   ADC_SLOPE.B
 191                         ;   ++ 0x04
 192  000000                                 EXTERN   ZERO_ADC.B
 193  000000                                 EXTERN   ZERO_ADC0.B
 194  000000                                 EXTERN   ZERO_ADC1.B
 195  000000                                 EXTERN   ZERO_ADC2.B
 196  000000                                 EXTERN   ZERO_ADC3.B
 197                                   
 198  000000                                 EXTERN   NET_ADC.B
 199  000000                                 EXTERN   NET_ADC0.B
 200  000000                                 EXTERN   NET_ADC1.B
 201  000000                                 EXTERN   NET_ADC2.B
 202  000000                                 EXTERN   NET_ADC3.B
 203                                   
 204  000000                                 EXTERN   NET_BUF.B
 205  000000                                 EXTERN   NET_BUF3.B
 206  000000                                 EXTERN   NET_BUF2.B
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 16  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 207  000000                                 EXTERN   NET_BUF1.B
 208  000000                                 EXTERN   NET_BUF0.B
 209                                   
 210                                   
 211  000000                                 EXTERN   WEIGHT_QUOTIENT.B
 212  000000                                 EXTERN   WEIGHT_REMAINDER.B
 213                                   
 214                                   
 215  000000                                 EXTERN   PRICE_MUL3.B
 216  000000                                 EXTERN   PRICE_MUL2.B
 217  000000                                 EXTERN   PRICE_MUL1.B
 218  000000                                 EXTERN   PRICE_MUL0.B
 219                                   
 220  000000                                 EXTERN   KEYDOWN_FLAG.B
 221                                   
 222                                   
 223  000000                                 EXTERN   KEYBOARD_STORE.B
 224                                   
 225  000000                                 EXTERN   KEYBOARD_S4.B
 226  000000                                 EXTERN   KEYBOARD_S3.B
 227  000000                                 EXTERN   KEYBOARD_S2.B
 228  000000                                 EXTERN   KEYBOARD_S1.B
 229  000000                                 EXTERN   KEYBOARD_S0.B
 230  000000                                 EXTERN   KEYBOARD_PTR.B
 231                                   
 232  000000                                 EXTERN   KEYBOARD_DOT_OK.B
 233                                   
 234  000000                                 EXTERN   KEYBOARD_PRICE_BUF_S4.B
 235  000000                                 EXTERN   KEYBOARD_PRICE_BUF_S3.B
 236  000000                                 EXTERN   KEYBOARD_PRICE_BUF_S2.B
 237  000000                                 EXTERN   KEYBOARD_PRICE_BUF_S1.B
 238  000000                                 EXTERN   KEYBOARD_PRICE_BUF_S0.B
 239                                   
 240                                   
 241  000000                                 EXTERN   KEYBOARD_THRESHOLD_BUF_S4.B
 242  000000                                 EXTERN   KEYBOARD_THRESHOLD_BUF_S3.B
 243  000000                                 EXTERN   KEYBOARD_THRESHOLD_BUF_S2.B
 244  000000                                 EXTERN   KEYBOARD_THRESHOLD_BUF_S1.B
 245  000000                                 EXTERN   KEYBOARD_THRESHOLD_BUF_S0.B
 246                                   
 247                                   
 248  000000                                 EXTERN   KEY_ARRAY_MENU.B
 249  000000                                 EXTERN   KEY_TYPING_FLAG.B
 250                                   
 251                                   
 252  000000                                 EXTERN   STR_MASS.B
 253  000000                                 EXTERN   CHAR_MASS9.B
 254  000000                                 EXTERN   CHAR_MASS8.B
 255  000000                                 EXTERN   CHAR_MASS7.B
 256  000000                                 EXTERN   CHAR_MASS6.B
 257  000000                                 EXTERN   CHAR_MASS5.B
 258  000000                                 EXTERN   CHAR_MASS4.B
 259  000000                                 EXTERN   CHAR_MASS3.B
 260  000000                                 EXTERN   CHAR_MASS2.B
 261  000000                                 EXTERN   CHAR_MASS1.B
 262  000000                                 EXTERN   CHAR_MASS0.B
 263  000000                                 EXTERN   CHAR_MASS_1.B
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 17  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 264                         
 265                                   
 266                                   
 267  000000                                 EXTERN   STR_PRICE.B
 268  000000                                 EXTERN   CHAR_PRICE5.B
 269  000000                                 EXTERN   CHAR_PRICE4.B
 270  000000                                 EXTERN   CHAR_PRICE3.B
 271  000000                                 EXTERN   CHAR_PRICE2.B
 272  000000                                 EXTERN   CHAR_PRICE1.B
 273  000000                                 EXTERN   CHAR_PRICE0.B
 274                                   
 275  000000                                 EXTERN   STR_THRESHOLD.B
 276  000000                                 EXTERN   CHAR_THRESHOLD7.B
 277  000000                                 EXTERN   CHAR_THRESHOLD6.B
 278  000000                                 EXTERN   CHAR_THRESHOLD5.B
 279  000000                                 EXTERN   CHAR_THRESHOLD4.B
 280  000000                                 EXTERN   CHAR_THRESHOLD3.B
 281  000000                                 EXTERN   CHAR_THRESHOLD2.B
 282  000000                                 EXTERN   CHAR_THRESHOLD1.B
 283  000000                                 EXTERN   CHAR_THRESHOLD0.B
 284                                   
 285                                   
 286                                   
 287  000000                                 EXTERN   STR_MONEY.B
 288  000000                                 EXTERN   CHAR_MONEY7.B
 289  000000                                 EXTERN   CHAR_MONEY6.B
 290  000000                                 EXTERN   CHAR_MONEY5.B
 291  000000                                 EXTERN   CHAR_MONEY4.B
 292  000000                                 EXTERN   CHAR_MONEY3.B
 293  000000                                 EXTERN   CHAR_MONEY2.B
 294  000000                                 EXTERN   CHAR_MONEY1.B
 295  000000                                 EXTERN   CHAR_MONEY0.B
 296                                   
 297                                   
 298  000000                                 EXTERN   STR_MAX_MASS.B
 299                                                          ;EXTERN CHAR_MAX_MASS11.B
 300                                                          ;EXTERN CHAR_MAX_MASS10.B
 301  000000                                 EXTERN   CHAR_MAX_MASS9.B
 302  000000                                 EXTERN   CHAR_MAX_MASS8.B
 303  000000                                 EXTERN   CHAR_MAX_MASS7.B
 304  000000                                 EXTERN   CHAR_MAX_MASS6.B
 305  000000                                 EXTERN   CHAR_MAX_MASS5.B
 306  000000                                 EXTERN   CHAR_MAX_MASS4.B
 307  000000                                 EXTERN   CHAR_MAX_MASS3.B
 308  000000                                 EXTERN   CHAR_MAX_MASS2.B
 309  000000                                 EXTERN   CHAR_MAX_MASS1.B
 310  000000                                 EXTERN   CHAR_MAX_MASS0.B
 311  000000                                 EXTERN   CHAR_MAX_MASS_1.B
 312                                   
 313  000000                                 #ENDIF   
 314                                   
 315                                   
<END_OF_INCLUSION>
   0  000000                                 #include "MacroFunction.inc"
   1                         
   2                                   
   3                                   
   4  000000                                 #IFDEF   1
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 18  Assembler
                                               e:\stm8s\electronic_scale\key.asm

   5                                   
   6  000000                                 #ELSE    
 103                                   
 104                                   
 105                                   
 106                                   
 107                                   
 108                                   
 109                                   
 110                                   
<END_OF_INCLUSION>
   0  000000                                 #include "Common.inc"
   1                                   
   2  000000 U                               #IFDEF   __COMMON_INC_
   5                                   
   6  000000                                 #define  __COMMON_INC_ 1
   7                                   
   8  000000                                 EXTERN   LCD_Delay.W 
   9  000000                                 EXTERN   ADC_Delay.W
  10  000000                                 EXTERN   KeyDelay.W
  11  000000                                 EXTERN   CPU_Delay_1us.W
  12  000000                                 EXTERN   MassDivider.W
  13                                                          ;EXTERN MassDivider_old.W
  14                                   
  15  000000                                 EXTERN   TriMul.W
  16  000000                                 EXTERN   QuadMul.W
  17  000000                                 EXTERN   TriDiv.W
  18                                   
  19  000000                                 #ENDIF   
  20                                   
  21                                   
<END_OF_INCLUSION>
  11                                   
  12                         
  13                                                          ;#define LCD_OE PB_ODR,#3
  14  000000                                 #define  LCD_RS PB_ODR,#5
  15  000000                                 #define  LCD_RW PB_ODR,#4
  16  000000                                 #define  LCD_E PB_ODR,#3
  17  000000                                 #define  LCD_SER PD_ODR,#2
  18  000000                                 #define  LCD_SRCLK PD_ODR,#5
  19  000000                                 #define  LCD_RCK PD_ODR,#3
  20                                   
  21                                   
  22  000000                                 #define  CHAR_I 0
  23  000000                                 #define  CHAR_I_R 1
  24  000000                                 #define  CHAR_II 2
  25  000000                                 #define  CHAR_II_R 3
  26  000000                                 #define  CHAR_III 4
  27  000000                                 #define  CHAR_III_R 5
  28                                   
  29                                                          ;#define LCD_OE PB_ODR,#0
  30                                   
  31                                   
  32  000000                                 #define  LCD_CMD_INIT #00111000B
  33                                                          ;   enable display, no cursor, 
                                                                ;no twinkle
  34  000000                                 #define  LCD_CMD_ON #00001100B
  35                                                          ;   disable display, no cursor, 
                                                                ;no twinkle
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 19  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  36  000000                                 #define  LCD_CMD_OFF #0000000B
  37  000000                                 #define  LCD_CMD_CLEAR #01H
  38  000000                                 #define  LCD_CMD_FOSC_ON #00001101B
  39  000000                                 #define  LCD_CMD_FOSC_OFF #00001100B
  40                                   
  41                                   
  42                                   
  43  000000                                 EXTERN   LCD_Init.W
  44  000000                                 EXTERN   LCD_WriChar.W
  45  000000                                 EXTERN   LCD_WriCMD.W
  46  000000                                 EXTERN   LCD_WriData.W
  47  000000                                 EXTERN   LCD_SerData.W
  48  000000                                 EXTERN   LCD_WriString.W
  49  000000                                 EXTERN   LCD_SetCursor.W
  50  000000                                 EXTERN   LCD_InitCustom.W
  51                                                          ;EXTERN LCD_ClearLine.W
  52                                   
  53  000000                                 EXTERN   EMPTY_LINE.W
  54                         ;
  55                         ;
  56                         ;
  57                         ;
  58  000000                                 #ENDIF   
  59                                   
  60                                   
  61                         
  62                                   
  63                                   
  64                                   
  65                                   
  66                                   
  67                                   
  68                                   
  69                         
  70                         
<END_OF_INCLUSION>
  10                                   
   0  000000                                 #include "GlobalVar.inc"
   1                         
   2  000000                                 #IFDEF   1
   3                                   
   4  000000                                 #ELSE    
 314                                   
 315                                   
<END_OF_INCLUSION>
   0  000000                                 #include "Common.inc"
   1                                   
   2  000000                                 #IFDEF   1
   3                                   
   4  000000                                 #ELSE    
  20                                   
  21                                   
<END_OF_INCLUSION>
  13                                   
  14                         ;***********************************************************
  15                         ;name   :(void)
  16                         ;          PrintChar (cor_x: x,
  17                         ;                     cor_y: y,
  18                         ;                     _char: char)
  19                         ;fun    : print char to LCD
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 20  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  20                         ;***********************************************************
  21  000000                       PrintChar  MACRO    cor_x,cor_y,_char
  22                                   mov      LCD_VAR0, cor_x
  23                                   mov      LCD_VAR1, cor_y
  24                                   mov      LCD_VAR2, _char
  25                                   call     LCD_WriChar
  26  000000                                 MEND     
  27                         
  28                         ;***********************************************************
  29                         ;name   :(void)
  30                         ;          LCD_ClearLine (line: _line)
  31                         ;fun    : print char to LCD
  32                         ;***********************************************************
  33  000000                       LCD_ClearLine  MACRO    _line
  34                                   PrintStr #0, #{_line+1}, #EMPTY_LINE
  35  000000                                 MEND     
  36                         
  37                         
  38                         ;***********************************************************
  39                         ;name   :(void)
  40                         ;          LCD_Scmd (_cmd: cmd)
  41                         ;fun    : print char to LCD
  42                         ;***********************************************************
  43  000000                       LCD_SCmd  MACRO    _cmd
  44                                   ld       A, _cmd
  45                                   call     LCD_WriCMD
  46  000000                                 MEND     
  47                                   
  48                         ;***********************************************************
  49                         ;name   :(void)
  50                         ;          LCD_SetCursor (_cmd: cmd)
  51                         ;fun    : print char to LCD
  52                         ;***********************************************************
  53  000000                       LCD_SetCursor_Macro  MACRO    _x,_y
  54                                   mov      LCD_VAR0, _x
  55                                   mov      LCD_VAR1, _y
  56                                   call     LCD_SetCursor
  57  000000                                 MEND     
  58                         
  59                                   
  60                         ;***********************************************************
  61                         ;name   :(void)
  62                         ;          LCD_Clear ()
  63                         ;fun    : clear LCD
  64                         ;***********************************************************
  65  000000                       LCD_Clear  MACRO    
  66                                   ld       A, #01H
  67                                   call     LCD_WriCMD
  68  000000                                 MEND     
  69                         
  70                         ;***********************************************************
  71                         ;name   :(void)
  72                         ;          PrintStr (start_x: start_x,
  73                         ;                    start_y: start_y,
  74                         ;                    str_ptr.W: str_ptr)
  75                         ;fun    : print char to LCD,
  76                         ;         string end with 0
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 21  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  77                         ;***********************************************************
  78  000000                       PrintStr  MACRO    start_x,start_y,str_ptr
  79                                   pushw    X
  80                                   mov      LCD_VAR0, start_x
  81                                   mov      LCD_VAR1, start_y
  82                                   ldw      X, str_ptr
  83                                   call     LCD_WriString
  84                                   popw     X
  85  000000                                 MEND     
  86                         
  87                         ;***********************************************************
  88                         ;name   : (Quotient: X, Remainder: Y)
  89                         ;           ADC_Convert (X: _divisor)
  90                         ;fun    : divide from [NET_ADC2:NET_ADC1:NET_ADC0]
  91                         ;***********************************************************
  92  000000                       ADC_Convert  MACRO    _divisor
  93                                   ldw      X, _divisor
  94                                   call     MassDivider
  95  000000                                 MEND     
  96                         
  97                         
  98                         
  99                         
 100                         
 101                                   
 102  000000                                 #ENDIF   
 103                                   
 104                                   
 105                                   
 106                                   
 107                                   
 108                                   
 109                                   
 110                                   
<END_OF_INCLUSION>
   0  000000                                 #include "Key.inc"
   1                         
   2  000000 U                               #IFDEF   __KEY_
   5  000000                                 #define  __KEY_ 1
   6                         
   7  000000                                 #define  KEY_ZERO PB_IDR,#0
   8  000000                                 #define  KEY_ARRAY PE_IDR,#5
   9                                   
  10  000000                                 #define  KEY_ROW1 PC_ODR,#7
  11  000000                                 #define  KEY_ROW2 PC_ODR,#6
  12  000000                                 #define  KEY_ROW3 PC_ODR,#5
  13  000000                                 #define  KEY_ROW4 PC_ODR,#4
  14                                   
  15  000000                                 #define  KEY_COL1 PC_IDR,#3
  16  000000                                 #define  KEY_COL2 PC_IDR,#2
  17  000000                                 #define  KEY_COL3 PC_IDR,#1
  18                                   
  19  000000                                 #define  KEY_NUM_DOT 0FEH
  20                                   
  21                                   
  22                         
  23  000000                                 EXTERN   KeyZero_Init.W
  24  000000                                 EXTERN   KeyZero_Handler.L
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 22  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  25                                   
  26  000000                                 EXTERN   KeyArray_Init.W
  27  000000                                 EXTERN   KeyArray_Scan.W
  28  000000                                 EXTERN   KeyArray_Handler.L
  29  000000                                 EXTERN   KeyArray_Settle.W
  30  000000                                 EXTERN   KeyArray_Display.W
  31  000000                                 EXTERN   TypingCursorFlash.W
  32  000000                                 EXTERN   PriceAlign.W
  33  000000                                 EXTERN   MoneyHandle.W
  34  000000                                 EXTERN   Cal_Money.W
  35                                   
  36  000000                                 #ENDIF   
<END_OF_INCLUSION>
   0  000000                                 #include "LCD.inc"
   1                                   
   2  000000                                 #IFDEF   1 1
   3                                   
   4  000000                                 #ELSE    
  59                                   
  60                                   
  61                         
  62                                   
  63                                   
  64                                   
  65                                   
  66                                   
  67                                   
  68                                   
  69                         
  70                         
<END_OF_INCLUSION>
   0  000000                                 #include "GlobalVar.inc"
   1                         
   2  000000                                 #IFDEF   1
   3                                   
   4  000000                                 #ELSE    
 314                                   
 315                                   
<END_OF_INCLUSION>
   0  000000                                 #include "Common.inc"
   1                                   
   2  000000                                 #IFDEF   1
   3                                   
   4  000000                                 #ELSE    
  20                                   
  21                                   
<END_OF_INCLUSION>
  10                                                          ;#include "Timer.inc"
  11                                   
  12                                   
  13  000000                                 EXTERN   KeyCalibrWizard_1.W
  14  000000                                 INTEL    
  15                                   segment  'rom'
  16                         
  17                         ;.KeyCalibrWizard_1.W STRING "***CALIBRATION**",0
  18                         ;.KeyCalibrWizard_2.W STRING " push 10g weight",0
  19                                   
  20                         .KeyZero_Init.W  
  21  008397   8A                            push     CC
  22  008398   88                            push     A
  23                                                          ; PB0 = Calibration Key
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 23  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  24                                                          ; --- INPUT: interrupt - falling
                                                                ; edge
  25                                   
  26  008399   72115007                      bres     PB_DDR, #0
  27  00839D   72105008                      bset     PB_CR1, #0
  28                         
  29  0083A1   9B                            sim      
  30  0083A2   C650A0                        ld       A, EXTI_CR1
  31  0083A5   AA08                          or       A, #00001000B
  32  0083A7   A4FB                          and      A, #11111011B
  33  0083A9   C750A0                        ld       EXTI_CR1, A
  34                                   
  35                                   
  36  0083AC   C67F71                        ld       A, ITC_SPR2
  37  0083AF   A4FC                          and      A, #11111100B
  38  0083B1   C77F71                        ld       ITC_SPR2, A
  39                                   
  40                                   
  41  0083B4   72105009                      bset     PB_CR2, #0
  42  0083B8   9A                            rim      
  43                                   
  44  0083B9   84                            pop      A
  45  0083BA   86                            pop      CC
  46  0083BB   81                            ret      
  47                         
  48                         
  49                         ;***********************************************************
  50                         ;name   : KEY_Zero_Handler()
  51                         ;from   : PB0 = falling edge
  52                         ;go     : calibrate ADC_Slope
  53                         ;pins   :
  54                         ;           IN  : NULL
  55                         ;           OUT : NULL
  56                         ;***********************************************************
  57                         .KeyZero_Handler.l  
  58  0083BC                                 INTERRUPT KeyZero_Handler
  59                                   
  60                                                          ;call KeyDelay
  61  0083BC   720050060C                    btjt     PB_IDR,#0,keyzero_handle_end
  62                                                          ;LCD_Clear
  63                                                          ;PrintStr 
                                                                ;#0,#0,#KeyCalibrWizard_1
  64                                                          ;PrintStr 
                                                                ;#0,#1,#KeyCalibrWizard_2
  65                                                          ;push CC
  66                                                          ;sim
  67  0083C1   45087F                        mov      ZERO_ADC3, ADC_AVG3
  68  0083C4   450980                        mov      ZERO_ADC2, ADC_AVG2
  69  0083C7   450A81                        mov      ZERO_ADC1, ADC_AVG1
  70  0083CA   450B82                        mov      ZERO_ADC0, ADC_AVG0
  71                                                          ;pop CC
  72                         
  73                         keyzero_handle_end:  
  74                                                          ;LCD_Clear
  75                                   
  76                         zero_wait_keyup:  
  77  0083CD   72015006FB                    btjf     PB_IDR,#0, zero_wait_keyup
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 24  Assembler
                                               e:\stm8s\electronic_scale\key.asm

  78                                   
  79  0083D2   80                            iret     
  80                         
  81                         
  82                         
  83                         ;***********************************************************
  84                         ;name   : KeyArray_Init()
  85                         ;from   : PE4: interrupt input ; PC1~4: row ; PC5~7 : col
  86                         ;go     : 
  87                         ;pins   :
  88                         ;           IN  : NULL
  89                         ;           OUT : NULL
  90                         ;***********************************************************
  91                         .KeyArray_Init.W  
  92  0083D3   8A                            push     CC
  93  0083D4   88                            push     A
  94                                   
  95                                   
  96                                                          ; PC4~7
  97                                                          ; OUTPUT
  98  0083D5   3500500A                      mov      PC_ODR, #0
  99                                   
 100  0083D9   C6500C                        ld       A, PC_DDR
 101  0083DC   AAF0                          or       A, #11110000B
 102  0083DE   C7500C                        ld       PC_DDR, A
 103                                   
 104                                                          ; open-drain output
 105  0083E1   C6500D                        ld       A, PC_CR1
 106  0083E4   A40F                          and      A, #00001111B
 107  0083E6   C7500D                        ld       PC_CR1, A
 108                                   
 109                                                          ; PC1~3
 110                                                          ; INPUT: interrupt
 111                                   
 112  0083E9   C6500C                        ld       A, PC_DDR
 113  0083EC   A4F1                          and      A, #11110001B
 114  0083EE   C7500C                        ld       PC_DDR, A
 115                                   
 116                                                          ; pull-up input
 117  0083F1   C6500D                        ld       A, PC_CR1
 118  0083F4   AAF0                          or       A, #11110000B
 119  0083F6   C7500D                        ld       PC_CR1, A
 120                                   
 121                                                          ; disable input interrupt, 2mhz 
                                                                ;output
 122  0083F9   3500500E                      mov      PC_CR2, #0
 123                                   
 124                                   
 125                                                          ; PE4 - input interrupt 
 126  0083FD   721B5016                      bres     PE_DDR, #5
 127  008401   721B5017                      bres     PE_CR1, #5
 128                         
 129  008405   9B                            sim      
 130  008406   C650A1                        ld       A, EXTI_CR2
 131  008409   AA02                          or       A, #00000010B
 132  00840B   A4FE                          and      A, #11111110B
 133  00840D   C750A1                        ld       EXTI_CR2, A
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 25  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 134                                   
 135                                   
 136  008410   C67F71                        ld       A, ITC_SPR2
 137  008413   A43F                          and      A, #00111111B
 138                                                          ;or A, #01000000B
 139  008415   C77F71                        ld       ITC_SPR2, A
 140                                   
 141                                   
 142  008418   721A5018                      bset     PE_CR2, #5
 143  00841C   9A                            rim      
 144                                   
 145                                                          ; init menu 1
 146  00841D   350100A6                      mov      KEY_ARRAY_MENU, #1
 147                                   
 148  008421   84                            pop      A
 149  008422   86                            pop      CC
 150  008423   81                            ret      
 151                         
 152                         
 153                         ;***********************************************************
 154                         ;name   : KeyArray_Handler()
 155                         ;from   : PE5 = falling edge
 156                         ;go     : 
 157                         ;pins   :
 158                         ;           IN  : NULL
 159                         ;           OUT : NULL
 160                         ;***********************************************************
 161                         .KeyArray_Handler.l  
 162  008424                                 INTERRUPT KeyArray_Handler
 163                                   
 164                                   
 165                                                          ; check KEYDOWN_FLAG
 166  008424   B693                          ld       A, KEYDOWN_FLAG
 167                                   
 168  008426   CD8A0C                        call     KeyDelay
 169  008429   CD8A0C                        call     KeyDelay
 170  00842C   CD8A0C                        call     KeyDelay
 171  00842F   CD8A0C                        call     KeyDelay
 172                                                          ; if KEYDOWN_FLAG == 0
 173  008432   260D                          jrne     keyarray_handle_end
 174                                   
 175                         
 176                         
 177                         keyarray_down_start:  
 178                         
 179  008434   720A501508                    btjt     PE_IDR,#5,keyarray_handle_end
 180                                   
 181                                   
 182  008439   CD8442                        call     KeyArray_Scan
 183                                   
 184                         wait_keyup:  
 185  00843C   720B5015FB                    btjf     PE_IDR,#5, wait_keyup
 186                                                          ; enable time4 interrupt to 
                                                                ;check and wait for key up 
 187                                                          ;bset CLK_PCKENR1, #6
 188                                                          ;mov KEYDOWN_FLAG, #1
 189                                                          ;bset TIM3_CR1, #0
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 26  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 190                                                          ;mov TIM3_CNTRH, #00H
 191                                                          ;mov TIM3_CNTRL, #00H
 192                                                          ;bset TIM3_IER, #0
 193                                                          ;call Timer4_KeyUp_Init
 194                                   
 195                                                          ;bres PE_CR2, #5
 196                                   
 197                                   
 198                                   
 199                         keyarray_handle_end:  
 200                                   
 201  008441   80                            iret     
 202                         
 203                         
 204                         
 205                         
 206                         ;***********************************************************
 207                         ;name   : KeyArray_Scan()
 208                         ;from   : PE4: interrupt input ; 
 209                         ;       : PC1~4: row - output
 210                         ;       : PC5~7 : col - input
 211                         ;go     : 
 212                         ;pins   :
 213                         ;           IN  : KEYBOARD_STATUS, KEYBOARD_S4~0
 214                         ;                 KEYBOARD_STORE , KEYBOARD_PTR
 215                         ;           OUT : KEYBOARD_STATUS, KEYBOARD_PTR
 216                         ;                 KEYBOARD_S4~0
 217                         ;       ----------
 218                         ;       7   8   9
 219                         ;       4   5   6
 220                         ;       1   2   3
 221                         ;       0   .   h
 222                         ;       ----------
 223                         ;   0xFE = '.'      0xFF = 'done'
 224                         ;***********************************************************
 225                         .KeyArray_Scan.W  
 226  008442   8A                            push     CC
 227  008443   88                            push     A
 228  008444   89                            pushw    X
 229                         
 230                                   
 231                                   
 232                         
 233                         keyarray_determine_col_start:  
 234                                                          ; determine col
 235  008445   7207500B10                    btjf     PC_IDR,#3, keyarray_col1
 236  00844A   7205500B52                    btjf     PC_IDR,#2, keyarray_col2
 237  00844F   7203500B03                    btjf     PC_IDR,#1, keyarray_col3_jp
 238                                   
 239  008454   CC8637                        jp       keyarray_scan_exit
 240                         
 241                         keyarray_col3_jp:  
 242  008457   CC84E2                        jp       keyarray_col3
 243                                                          ; ------- column 1 --------
 244                         keyarray_col1:  
 245                                   
 246                         col1_row1:  
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 27  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 247  00845A   721E500A                      bset     PC_ODR,#7
 248  00845E   CD8A0C                        call     KeyDelay
 249  008461   7207500B05                    btjf     PC_IDR,#3, col1_row2
 250  008466   A607                          ld       A, #7
 251                                                          ;call 
 252  008468   CC8528                        jp       keyarray_num
 253                         col1_row2:  
 254  00846B   721C500A                      bset     PC_ODR,#6
 255  00846F   CD8A0C                        call     KeyDelay
 256  008472   7207500B05                    btjf     PC_IDR,#3, col1_row3
 257  008477   A604                          ld       A, #4
 258                                                          ;call
 259  008479   CC8528                        jp       keyarray_num
 260                         col1_row3:  
 261  00847C   721A500A                      bset     PC_ODR,#5
 262  008480   CD8A0C                        call     KeyDelay
 263  008483   7207500B05                    btjf     PC_IDR,#3, col1_row4
 264  008488   A601                          ld       A, #1
 265                                                          ;call
 266  00848A   CC8528                        jp       keyarray_num
 267                         col1_row4:  
 268  00848D   7218500A                      bset     PC_ODR,#4
 269  008491   CD8A0C                        call     KeyDelay
 270  008494   7207500B05                    btjf     PC_IDR,#3, keyarray_exit_jp
 271  008499   A600                          ld       A, #0
 272                                                          ;call
 273  00849B   CC8528                        jp       keyarray_num
 274                                   
 275                         ; because of the limit of the addressing mode
 276                         keyarray_exit_jp:  
 277  00849E   CC8637                        jp       keyarray_scan_exit
 278                         
 279                         
 280                                                          ; ------- column 2 --------
 281                         keyarray_col2:  
 282                         
 283                         col2_row1:  
 284  0084A1   721E500A                      bset     PC_ODR,#7
 285  0084A5   CD8A0C                        call     KeyDelay
 286  0084A8   7205500B04                    btjf     PC_IDR,#2, col2_row2
 287  0084AD   A608                          ld       A, #8
 288                                                          ;call 
 289  0084AF   2077                          jra      keyarray_num
 290                         col2_row2:  
 291  0084B1   721C500A                      bset     PC_ODR,#6
 292  0084B5   CD8A0C                        call     KeyDelay
 293  0084B8   7205500B04                    btjf     PC_IDR,#2, col2_row3
 294  0084BD   A605                          ld       A, #5
 295                                                          ;call
 296  0084BF   2067                          jra      keyarray_num
 297                         col2_row3:  
 298  0084C1   721A500A                      bset     PC_ODR,#5
 299  0084C5   CD8A0C                        call     KeyDelay
 300  0084C8   7205500B04                    btjf     PC_IDR,#2, col2_row4
 301  0084CD   A602                          ld       A, #2
 302                                                          ;call
 303  0084CF   2057                          jra      keyarray_num
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 28  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 304                         col2_row4:  
 305  0084D1   7218500A                      bset     PC_ODR,#4
 306  0084D5   CD8A0C                        call     KeyDelay
 307  0084D8   7205500B48                    btjf     PC_IDR,#2, col23_keyarray_exit_jp
 308  0084DD   A6FE                          ld       A, #0FEH      ; 0xFE + 0x30 = .  (0x28 - 
                                                                ;ASCII)
 309                                                          ;call
 310  0084DF   CC8566                        jp       keyarray_dot
 311                         
 312                         
 313                         
 314                                                          ; ------- column 3 --------
 315                         keyarray_col3:  
 316                         
 317                         col3_row1:  
 318  0084E2   721E500A                      bset     PC_ODR,#7
 319  0084E6   CD8A0C                        call     KeyDelay
 320  0084E9   7203500B04                    btjf     PC_IDR,#1, col3_row2
 321  0084EE   A609                          ld       A, #9
 322                                                          ;call 
 323  0084F0   2036                          jra      keyarray_num
 324                         col3_row2:  
 325  0084F2   721C500A                      bset     PC_ODR,#6
 326  0084F6   CD8A0C                        call     KeyDelay
 327  0084F9   7203500B04                    btjf     PC_IDR,#1, col3_row3
 328  0084FE   A606                          ld       A, #6
 329                                                          ;call
 330  008500   2026                          jra      keyarray_num
 331                         col3_row3:  
 332  008502   721A500A                      bset     PC_ODR,#5
 333  008506   CD8A0C                        call     KeyDelay
 334  008509   7203500B04                    btjf     PC_IDR,#1, col3_row4
 335  00850E   A603                          ld       A, #3
 336                                                          ;call
 337  008510   2016                          jra      keyarray_num
 338                         col3_row4:  
 339  008512   7218500A                      bset     PC_ODR,#4
 340  008516   CD8A0C                        call     KeyDelay
 341  008519   7203500B07                    btjf     PC_IDR,#1, col23_keyarray_exit_jp
 342  00851E   A6FF                          ld       A, #0FFH
 343                                                          ;call
 344  008520   2000                          jra      col3_keyarray_done_jp
 345                         
 346                         
 347                         col3_keyarray_done_jp:  
 348  008522   CC85C0                        jp       keyarray_done
 349                         
 350                                                          ;;;;;;;;;;;;;
 351                         col23_keyarray_exit_jp:  
 352  008525   CC8637                        jp       keyarray_scan_exit
 353                         
 354                         
 355                                                          ; 
                                                                ;-------------------------------
                                                                ;----------------
 356                                                          ; 
                                                                ;-------------------------------
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 29  Assembler
                                               e:\stm8s\electronic_scale\key.asm

                                                                ;----------------
 357                         keyarray_num:  
 358  008528   88                            push     A
 359  008529   B6A6                          ld       A, KEY_ARRAY_MENU
 360  00852B   A102                          cp       A, #2
 361  00852D   2603                          jrne     keyarray_num_start
 362                                   
 363                         keyarray_num_menu_2:  
 364  00852F   84                            pop      A
 365  008530   20F3                          jra      col23_keyarray_exit_jp
 366                         ;keyarray_num_menu_2_to_1:
 367                         ;    LCD_ClearLine 2
 368                         
 369                         keyarray_num_start:  
 370                                   
 371                                   
 372                                   
 373  008532   350100A7                      mov      KEY_TYPING_FLAG, #1
 374                                                          ;ld A, KEY_ARRAY_MENU
 375  008536   A103                          cp       A, #3
 376  008538   270D                          jreq     keyarray_num_menu_3
 377                                   
 378                                                          ;mov KEY_ARRAY_MENU, #1
 379                                                          ;ld A, 
 380                                   
 381                         keyarray_num_menu_1:  
 382  00853A   84                            pop      A
 383  00853B   BE99                          ldw      X, KEYBOARD_PTR
 384                                                          ; if current ptr is 3, but it 
                                                                ;has to be a dot .
 385                                                          ; , so mov it to KEYBOARD_S0(ptr
                                                                ; = 4)
 386  00853D   88                            push     A
 387  00853E   B69B                          ld       A, KEYBOARD_DOT_OK
 388  008540   2711                          jreq     keyarray_num_no_dot
 389  008542   84                            pop      A
 390  008543   E794                          ld       (KEYBOARD_STORE,X), A
 391  008545   2079                          jra      keyarray_done
 392                                   
 393                         keyarray_num_menu_3:  
 394  008547   84                            pop      A
 395  008548   BE99                          ldw      X, KEYBOARD_PTR
 396  00854A   E794                          ld       (KEYBOARD_STORE,X), A
 397  00854C   A30004                        cpw      X, #4
 398  00854F   276F                          jreq     keyarray_done
 399                                   
 400  008551   200D                          jra      keyarray_num_dot_exit_inc_jp
 401                         
 402                         keyarray_num_no_dot:  
 403  008553   84                            pop      A
 404  008554   A30003                        cpw      X, #3
 405  008557   2707                          jreq     keyarray_num_dot_exit_inc_jp
 406                                   
 407                         
 408                                                          ; inc ptr
 409                                                          ;incw X
 410                         keyarray_ptr_cur:  
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 30  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 411                                                          ;ld (KEYBOARD_STORE,X), A
 412                         
 413  008559   A30004                        cpw      X, #4
 414  00855C   2762                          jreq     keyarray_done
 415                                                          ; done
 416                                   
 417                                                          ;call KeyArray_Settle
 418  00855E   2000                          jra      keyarray_num_dot_exit_inc_jp
 419                                                          ;call done
 420                                   
 421                                                          ;;;;;;;;;
 422                         keyarray_num_dot_exit_inc_jp:  
 423  008560   CC8624                        jp       keyarray_scan_exit_inc
 424                                   
 425                         keyarray_num_dot_exit_jp:  
 426  008563   CC8637                        jp       keyarray_scan_exit    
 427                                   
 428                                   
 429                                                          ; 
                                                                ;-------------------------------
                                                                ;----------------
 430                                                          ; 
                                                                ;-------------------------------
                                                                ;----------------
 431                         keyarray_dot:  
 432  008566   88                            push     A
 433  008567   B6A6                          ld       A, KEY_ARRAY_MENU
 434  008569   A101                          cp       A, #1
 435  00856B   2739                          jreq     keyarray_dot_menu_1
 436  00856D   A102                          cp       A, #2
 437  00856F   2702                          jreq     keyarray_dot_menu_2
 438  008571   20F0                          jra      keyarray_num_dot_exit_jp
 439                                   
 440                         keyarray_dot_menu_2:  
 441  008573   84                            pop      A
 442                                                          ; clear max hold
 443                                   
 444  008574   353000CF                      mov      CHAR_MAX_MASS7, #'0'
 445  008578   353000D0                      mov      CHAR_MAX_MASS6, #'0'
 446  00857C   353000D1                      mov      CHAR_MAX_MASS5, #'0'
 447  008580   353000D2                      mov      CHAR_MAX_MASS4, #'0'
 448  008584   353000D3                      mov      CHAR_MAX_MASS3, #'0'
 449  008588   352E00D4                      mov      CHAR_MAX_MASS2, #'.'
 450  00858C   353000D5                      mov      CHAR_MAX_MASS1, #'0'
 451  008590   356700D6                      mov      CHAR_MAX_MASS0, #'g'
 452                                   
 453  008594   35000077                      mov      ADC_MAX_QUOTIENT_S1, #0
 454  008598   35000078                      mov      ADC_MAX_QUOTIENT_S0, #0
 455                                   
 456  00859C   35000079                      mov      ADC_MAX_REMAINDER_S1, #0
 457  0085A0   3500007A                      mov      ADC_MAX_REMAINDER_S0, #0
 458                                   
 459  0085A4   20BD                          jra      keyarray_num_dot_exit_jp
 460                         keyarray_dot_menu_1:  
 461  0085A6   84                            pop      A
 462                                                          ;mov KEY_TYPING_FLAG, #1
 463  0085A7   B69B                          ld       A, KEYBOARD_DOT_OK
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 31  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 464  0085A9   26B8                          jrne     keyarray_num_dot_exit_jp
 465                                   
 466  0085AB   A6FE                          ld       A, #0FEH
 467                                   
 468  0085AD   BE99                          ldw      X, KEYBOARD_PTR
 469                                                          ; if current ptr is 0, but it 
                                                                ;has to be a num.
 470                                                          ; , so handle it as a fraction 
                                                                ;with 0 integer
 471                                                          ;cpw X, #0
 472                                                          ;incw X
 473  0085AF   A30004                        cpw      X, #4
 474  0085B2   27AF                          jreq     keyarray_num_dot_exit_jp
 475                                   
 476  0085B4   3501009B                      mov      KEYBOARD_DOT_OK, #1
 477                                                          ;ld (KEYBOARD_STORE,X), A
 478                                   
 479  0085B8   A30000                        cpw      X, #0
 480  0085BB   2667                          jrne     keyarray_scan_exit_inc
 481                                                          ; if ptr = 0
 482                                   
 483                                                          ;ld (KEYBOARD_STORE,X), A
 484  0085BD   5C                            incw     X
 485  0085BE   2064                          jra      keyarray_scan_exit_inc
 486                                   
 487                                                          ; 
                                                                ;-------------------------------
                                                                ;----------------
 488                                                          ; 
                                                                ;-------------------------------
                                                                ;----------------
 489                         keyarray_done:  
 490  0085C0   88                            push     A
 491                                   
 492  0085C1   B6A7                          ld       A, KEY_TYPING_FLAG
 493  0085C3   2653                          jrne     keyarray_done_menu_1_3
 494                         
 495  0085C5   B6A6                          ld       A, KEY_ARRAY_MENU
 496  0085C7   A101                          cp       A, #1
 497  0085C9   271F                          jreq     keyarray_menu_to_2
 498                                   
 499  0085CB   A102                          cp       A, #2
 500  0085CD   2704                          jreq     keyarray_menu_to_3
 501                         
 502  0085CF   A103                          cp       A, #3
 503  0085D1   272E                          jreq     keyarray_menu_to_1
 504                         
 505                         keyarray_menu_to_3:  
 506                                   LCD_ClearLine 2
 506                                   PrintStr #0, #{2+1}, #EMPTY_LINE
 506  0085D3   89                            pushw    X
 506  0085D4   35000000                      mov      LCD_VAR0, #0
 506  0085D8   35030001                      mov      LCD_VAR1, #{2+1}
 506  0085DC   AE816D                        ldw      X, #EMPTY_LINE
 506  0085DF   CD82EA                        call     LCD_WriString
 506  0085E2   85                            popw     X
 507  0085E3   84                            pop      A
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 32  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 508  0085E4   350300A6                      mov      KEY_ARRAY_MENU, #3
 509  0085E8   204D                          jra      keyarray_scan_exit
 510                         
 511                         keyarray_menu_to_2:  
 512                                   LCD_ClearLine 2
 512                                   PrintStr #0, #{2+1}, #EMPTY_LINE
 512  0085EA   89                            pushw    X
 512  0085EB   35000000                      mov      LCD_VAR0, #0
 512  0085EF   35030001                      mov      LCD_VAR1, #{2+1}
 512  0085F3   AE816D                        ldw      X, #EMPTY_LINE
 512  0085F6   CD82EA                        call     LCD_WriString
 512  0085F9   85                            popw     X
 513  0085FA   84                            pop      A
 514  0085FB   350200A6                      mov      KEY_ARRAY_MENU, #2
 515  0085FF   2036                          jra      keyarray_scan_exit
 516                                   
 517                         keyarray_menu_to_1:  
 518                                   LCD_ClearLine 2
 518                                   PrintStr #0, #{2+1}, #EMPTY_LINE
 518  008601   89                            pushw    X
 518  008602   35000000                      mov      LCD_VAR0, #0
 518  008606   35030001                      mov      LCD_VAR1, #{2+1}
 518  00860A   AE816D                        ldw      X, #EMPTY_LINE
 518  00860D   CD82EA                        call     LCD_WriString
 518  008610   85                            popw     X
 519  008611   84                            pop      A
 520  008612   350100A6                      mov      KEY_ARRAY_MENU, #1
 521  008616   201F                          jra      keyarray_scan_exit
 522                                   
 523                         
 524                         keyarray_done_menu_1_3:  
 525  008618   84                            pop      A
 526                         
 527  008619   E794                          ld       (KEYBOARD_STORE,X), A
 528  00861B   B69A                          ld       A, {KEYBOARD_PTR+1}
 529  00861D   2718                          jreq     keyarray_scan_exit
 530                                   
 531                                                          ;call Price_Align
 532  00861F   CD86D7                        call     KeyArray_Settle
 533  008622   2013                          jra      keyarray_scan_exit
 534                         
 535                         
 536                         
 537                         keyarray_scan_exit_inc:  
 538  008624   E794                          ld       (KEYBOARD_STORE,X), A
 539  008626   5C                            incw     X
 540  008627   BF99                          ldw      KEYBOARD_PTR, X
 541                                   
 542  008629   B6A6                          ld       A, KEY_ARRAY_MENU
 543  00862B   A101                          cp       A, #1
 544  00862D   2705                          jreq     scan_exit_inc_menu_1
 545  00862F   CD870A                        call     ThresholdInputHandle
 546  008632   2003                          jra      keyarray_scan_exit
 547                         scan_exit_inc_menu_1:  
 548  008634   CD8767                        call     PriceAlign
 549                                                          ;call KeyArray_Display
 550                                   
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 33  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 551                         keyarray_scan_exit:  
 552                                                          ; restore output 0
 553  008637   3500500A                      mov      PC_ODR, #0
 554                                   
 555  00863B   CD87C8                        call     KeyArray_Display
 556                                   
 557                                                          ; 
                                                                ;-------------------------------
                                                                ;----------------
 558                                                          ; 
                                                                ;-------------------------------
                                                                ;----------------    
 559  00863E   B6A6                          ld       A, KEY_ARRAY_MENU
 560  008640   A102                          cp       A, #2
 561  008642   2733                          jreq     keyarray_scan_menu_2
 562  008644   A103                          cp       A, #3
 563  008646   275E                          jreq     keyarray_scan_menu_3
 564                                   PrintChar #13, #0, #1
 564  008648   350D0000                      mov      LCD_VAR0, #13
 564  00864C   35000001                      mov      LCD_VAR1, #0
 564  008650   35010002                      mov      LCD_VAR2, #1
 564  008654   CD82D2                        call     LCD_WriChar
 565  008657                                 PrintChar #14, #0, #2
 565  008657   350E0000                      mov      LCD_VAR0, #14
 565  00865B   35000001                      mov      LCD_VAR1, #0
 565  00865F   35020002                      mov      LCD_VAR2, #2
 565  008663   CD82D2                        call     LCD_WriChar
 566  008666                                 PrintChar #15, #0, #4
 566  008666   350F0000                      mov      LCD_VAR0, #15
 566  00866A   35000001                      mov      LCD_VAR1, #0
 566  00866E   35040002                      mov      LCD_VAR2, #4
 566  008672   CD82D2                        call     LCD_WriChar
 567  008675   205C                          jra      keyarray_scan_menu_exit
 568                         keyarray_scan_menu_2:  
 569                                   PrintChar #13, #0, #0
 569  008677   350D0000                      mov      LCD_VAR0, #13
 569  00867B   35000001                      mov      LCD_VAR1, #0
 569  00867F   35000002                      mov      LCD_VAR2, #0
 569  008683   CD82D2                        call     LCD_WriChar
 570  008686                                 PrintChar #14, #0, #3
 570  008686   350E0000                      mov      LCD_VAR0, #14
 570  00868A   35000001                      mov      LCD_VAR1, #0
 570  00868E   35030002                      mov      LCD_VAR2, #3
 570  008692   CD82D2                        call     LCD_WriChar
 571  008695                                 PrintChar #15, #0, #4
 571  008695   350F0000                      mov      LCD_VAR0, #15
 571  008699   35000001                      mov      LCD_VAR1, #0
 571  00869D   35040002                      mov      LCD_VAR2, #4
 571  0086A1   CD82D2                        call     LCD_WriChar
 572  0086A4   202D                          jra      keyarray_scan_menu_exit
 573                         keyarray_scan_menu_3:  
 574                                   PrintChar #13, #0, #0
 574  0086A6   350D0000                      mov      LCD_VAR0, #13
 574  0086AA   35000001                      mov      LCD_VAR1, #0
 574  0086AE   35000002                      mov      LCD_VAR2, #0
 574  0086B2   CD82D2                        call     LCD_WriChar
 575  0086B5                                 PrintChar #14, #0, #2
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 34  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 575  0086B5   350E0000                      mov      LCD_VAR0, #14
 575  0086B9   35000001                      mov      LCD_VAR1, #0
 575  0086BD   35020002                      mov      LCD_VAR2, #2
 575  0086C1   CD82D2                        call     LCD_WriChar
 576  0086C4                                 PrintChar #15, #0, #5
 576  0086C4   350F0000                      mov      LCD_VAR0, #15
 576  0086C8   35000001                      mov      LCD_VAR1, #0
 576  0086CC   35050002                      mov      LCD_VAR2, #5
 576  0086D0   CD82D2                        call     LCD_WriChar
 577  0086D3                                 
 578                         keyarray_scan_menu_exit:  
 579  0086D3   85                            popw     X
 580  0086D4   84                            pop      A
 581  0086D5   86                            pop      CC
 582  0086D6   81                            ret      
 583                         
 584                         
 585                         ;***********************************************************
 586                         ;name   : KeyArray_Settle()
 587                         ;from   : PE4: interrupt input ; 
 588                         ;       : PC1~4: row - output
 589                         ;       : PC5~7 : col - input
 590                         ;go     : 
 591                         ;pins   :
 592                         ;           IN  : NULL
 593                         ;           OUT : NULL
 594                         ;                       0xFE = '.'
 595                         ;***********************************************************
 596                         
 597                         .KeyArray_Settle.W  
 598  0086D7   8A                            push     CC
 599  0086D8   88                            push     A
 600                                   
 601  0086D9   B6A6                          ld       A, KEY_ARRAY_MENU
 602  0086DB   A103                          cp       A, #3
 603  0086DD   2718                          jreq     keyarray_settle_menu_3
 604                                   
 605                         keyarray_settle_menu_1:  
 606  0086DF   CD8767                        call     PriceAlign
 607                                                          ;call KeyArray_Display
 608                                   
 609  0086E2   3F94                          clr      KEYBOARD_S4
 610  0086E4   3F95                          clr      KEYBOARD_S3
 611  0086E6   3F96                          clr      KEYBOARD_S2
 612  0086E8   3F97                          clr      KEYBOARD_S1
 613                                                          ;mov KEYBOARD_S1, #KEY_DOT_NUM
 614  0086EA   3F98                          clr      KEYBOARD_S0
 615                                   
 616                                   
 617                                   
 618  0086EC   3500009B                      mov      KEYBOARD_DOT_OK, #0
 619                                   
 620                                   LCD_SCmd #00001100B
 620  0086F0   A60C                          ld       A, #00001100B
 620  0086F2   CD832D                        call     LCD_WriCMD
 621  0086F5   2008                          jra      keyarray_settle_exit
 622                                   
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 35  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 623                         keyarray_settle_menu_3:  
 624                         
 625  0086F7   CD870A                        call     ThresholdInputHandle
 626                                   LCD_SCmd #00001100B
 626  0086FA   A60C                          ld       A, #00001100B
 626  0086FC   CD832D                        call     LCD_WriCMD
 627  0086FF                                 
 628                                   
 629                         keyarray_settle_exit:  
 630                                                          ; 
 631  0086FF   3F99                          clr      {KEYBOARD_PTR+0}
 632  008701   3F9A                          clr      {KEYBOARD_PTR+1}
 633  008703   350000A7                      mov      KEY_TYPING_FLAG, #0
 634                                   
 635  008707   84                            pop      A
 636  008708   86                            pop      CC
 637  008709   81                            ret      
 638                         
 639                         
 640                         ;***********************************************************
 641                         ;name   : ThresholdInputHandle()
 642                         ;from   : 
 643                         ;go     : 
 644                         ;pins   :
 645                         ;           IN  : NULL
 646                         ;           OUT : NULL
 647                         ;***********************************************************
 648                         .ThresholdInputHandle.W  
 649  00870A   8A                            push     CC
 650  00870B   88                            push     A
 651  00870C   89                            pushw    X
 652                                   
 653                                                          ;clr CHAR_THRESHOLD7
 654                                                          ;clr CHAR_THRESHOLD6
 655                                                          ;clr CHAR_THRESHOLD5
 656                                                          ;clr CHAR_THRESHOLD4
 657                                                          ;clr CHAR_THRESHOLD3
 658                                                          ;clr CHAR_THRESHOLD2
 659                                                          ;clr CHAR_THRESHOLD1
 660                                                          ;clr CHAR_THRESHOLD0
 661                                   LCD_SCmd #00001101B
 661  00870D   A60D                          ld       A, #00001101B
 661  00870F   CD832D                        call     LCD_WriCMD
 662  008712   4594A1                        mov      KEYBOARD_THRESHOLD_BUF_S4, KEYBOARD_S4
 663  008715   4595A2                        mov      KEYBOARD_THRESHOLD_BUF_S3, KEYBOARD_S3
 664  008718   4596A3                        mov      KEYBOARD_THRESHOLD_BUF_S2, KEYBOARD_S2
 665  00871B   4597A4                        mov      KEYBOARD_THRESHOLD_BUF_S1, KEYBOARD_S1
 666  00871E   4598A5                        mov      KEYBOARD_THRESHOLD_BUF_S0, KEYBOARD_S0
 667                                   
 668                                   
 669  008721   4B00                          push     #0
 670  008723   4B00                          push     #0
 671                                   
 672                                                          ;-------------
 673                                                          ;   HIGH STACK
 674                                                          ;+2 XL(threshold)
 675                                                          ;+1 XH(threshold)
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 36  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 676                                                          ;   LOW STACK
 677                                                          ;-------------
 678                                   
 679                                                          ; x100000
 680  008725   B6A1                          ld       A, KEYBOARD_THRESHOLD_BUF_S4
 681  008727   AE2710                        ldw      X, #10000
 682  00872A   CD8A5C                        call     TriMul
 683                                                          ; A:X < 0x00FFFF
 684  00872D   72FB01                        addw     X, (1,SP)
 685  008730   1F01                          ldw      (1,SP), X
 686                                   
 687                                                          ; x1000
 688  008732   B6A2                          ld       A, KEYBOARD_THRESHOLD_BUF_S3
 689  008734   AE03E8                        ldw      X, #1000
 690  008737   CD8A5C                        call     TriMul
 691                         
 692  00873A   72FB01                        addw     X, (1,SP)
 693  00873D   1F01                          ldw      (1,SP), X
 694                                   
 695                                                          ; x100
 696  00873F   B6A3                          ld       A, KEYBOARD_THRESHOLD_BUF_S2
 697  008741   AE0064                        ldw      X, #100
 698  008744   CD8A5C                        call     TriMul
 699                         
 700  008747   72FB01                        addw     X, (1,SP)
 701  00874A   1F01                          ldw      (1,SP), X
 702                                   
 703                                                          ; x10
 704  00874C   B6A4                          ld       A, KEYBOARD_THRESHOLD_BUF_S1
 705  00874E   AE000A                        ldw      X, #10
 706  008751   CD8A5C                        call     TriMul
 707                         
 708  008754   72FB01                        addw     X, (1,SP)
 709  008757   1F01                          ldw      (1,SP), X
 710                                   
 711                                                          ; x1
 712  008759   B6A5                          ld       A, KEYBOARD_THRESHOLD_BUF_S0
 713  00875B   5F                            clrw     X
 714  00875C   97                            ld       XL, A
 715                         
 716  00875D   72FB01                        addw     X, (1,SP)
 717                                                          ;ldw (1,SP), X
 718  008760   85                            popw     X
 719  008761   BF75                          ldw      ADC_THRESHOLD_QUOTIENT, X
 720                                   
 721                                   
 722                         
 723  008763   85                            popw     X
 724  008764   84                            pop      A
 725  008765   86                            pop      CC
 726  008766   81                            ret      
 727                         
 728                         
 729                         
 730                         
 731                         ;***********************************************************
 732                         ;name   : PriceAlign()
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 37  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 733                         ;from   : 
 734                         ;go     : 
 735                         ;pins   :
 736                         ;           IN  : NULL
 737                         ;           OUT : NULL
 738                         ;                       0xFE = '.'
 739                         ;***********************************************************
 740                         .PriceAlign.W  
 741  008767   8A                            push     CC
 742  008768   88                            push     A
 743  008769   89                            pushw    X
 744                                   
 745                                                          ;clr KEYBOARD_BUF_S4
 746  00876A   3F9C                          clr      KEYBOARD_PRICE_BUF_S4
 747  00876C   3F9D                          clr      KEYBOARD_PRICE_BUF_S3
 748  00876E   3F9E                          clr      KEYBOARD_PRICE_BUF_S2
 749  008770   35FE009F                      mov      KEYBOARD_PRICE_BUF_S1, #0FEH
 750  008774   3FA0                          clr      KEYBOARD_PRICE_BUF_S0
 751                                   
 752  008776   B69A                          ld       A, {KEYBOARD_PTR+1}
 753  008778   274A                          jreq     price_align_exit
 754                                                          ; align the num and dot
 755  00877A   A101                          cp       A, #1
 756  00877C   2605                          jrne     keyarray_align_start
 757                                   LCD_SCmd #00001101B
 757  00877E   A60D                          ld       A, #00001101B
 757  008780   CD832D                        call     LCD_WriCMD
 758  008783                       
 759                         keyarray_align_start:  
 760  008783   B69B                          ld       A, KEYBOARD_DOT_OK
 761                                                          ; cp A, #0
 762  008785   2722                          jreq     keyarray_dot_false  ;
 763                         keyarray_dot_true:  
 764                                                          ;ldw X, KEYBOARD_PTR
 765  008787   B69A                          ld       A, {KEYBOARD_PTR+1}
 766  008789   4A                            dec      A
 767                                                          ; A = ptr
 768                                                          ;push A
 769                                                          ; 3 - A = -(A - 3)
 770  00878A   A003                          sub      A, #3
 771  00878C   40                            neg      A
 772                                                          ; A = 3-A
 773  00878D   5F                            clrw     X
 774  00878E   97                            ld       XL, A
 775                                                          ;pop A
 776  00878F   B69A                          ld       A, {KEYBOARD_PTR+1}
 777  008791   1C009C                        addw     X, #KEYBOARD_PRICE_BUF_S4
 778                                                          ; X = ptr + buf_start
 779  008794   90AE0094                      ldw      Y, #KEYBOARD_STORE
 780                                                          ;addw Y, KEYBOARD_PTR
 781                                                          ; Y => X
 782                                                          ; Y = ptr + keyboard_start
 783                                                          ; A = loop counter
 784                         keyarray_dot_true_align_loop:  
 785                                                          ;ld A, #KEYBOARD_STORE
 786  008798   88                            push     A
 787  008799   90F6                          ld       A, (Y)
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 38  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 788                                                          ;add A, #30H  ; ascii : A + '0'
 789  00879B   F7                            ld       (X), A
 790  00879C   84                            pop      A
 791  00879D   905C                          incw     Y
 792  00879F   5C                            incw     X
 793  0087A0   4A                            dec      A
 794  0087A1   26F5                          jrne     keyarray_dot_true_align_loop
 795                                   
 796  0087A3   90F6                          ld       A, (Y)
 797                                                          ;add A, #30H
 798  0087A5   B7A0                          ld       KEYBOARD_PRICE_BUF_S0, A
 799  0087A7   201B                          jra      price_align_exit
 800                                   
 801                                   
 802                         keyarray_dot_false:  
 803  0087A9   B69A                          ld       A, {KEYBOARD_PTR+1}
 804                                                          ; A = ptr
 805                                                          ;push A
 806                                                          ; 3 - A = -(A - 3)
 807  0087AB   A003                          sub      A, #3
 808  0087AD   40                            neg      A
 809                                                          ; A = 3-A
 810  0087AE   5F                            clrw     X
 811  0087AF   97                            ld       XL, A
 812                                                          ;pop A
 813  0087B0   B69A                          ld       A, {KEYBOARD_PTR+1}
 814  0087B2   1C009C                        addw     X, #KEYBOARD_PRICE_BUF_S4
 815                                                          ; X = ptr + buf_start
 816  0087B5   90AE0094                      ldw      Y, #KEYBOARD_STORE
 817                                                          ;addw Y, KEYBOARD_PTR
 818                                                          ; Y => X
 819                                                          ; Y = ptr + keyboard_start
 820                                                          ; A = loop counter
 821                         keyarray_dot_false_align_loop:  
 822                                                          ;ld A, #KEYBOARD_STORE
 823  0087B9   88                            push     A
 824  0087BA   90F6                          ld       A, (Y)
 825                                                          ;add A, #30H  ; ascii : A + '0'
 826  0087BC   F7                            ld       (X), A
 827  0087BD   84                            pop      A
 828  0087BE   905C                          incw     Y
 829  0087C0   5C                            incw     X
 830  0087C1   4A                            dec      A
 831  0087C2   26F5                          jrne     keyarray_dot_false_align_loop
 832                         
 833                         price_align_exit:  
 834                         
 835  0087C4   85                            popw     X
 836  0087C5   84                            pop      A
 837  0087C6   86                            pop      CC
 838  0087C7   81                            ret      
 839                         
 840                         ;***********************************************************
 841                         ;name   : KeyArray_Display()
 842                         ;from   : PE4: interrupt input ; 
 843                         ;       : PC1~4: row - output
 844                         ;       : PC5~7 : col - input
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 39  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 845                         ;go     : 
 846                         ;pins   :
 847                         ;           IN  : NULL
 848                         ;           OUT : NULL
 849                         ;                       0xFE = '.'
 850                         ;***********************************************************
 851                         .KeyArray_Display.W  
 852  0087C8   8A                            push     CC
 853  0087C9   88                            push     A
 854  0087CA   89                            pushw    X
 855                                   
 856  0087CB   B6A6                          ld       A, KEY_ARRAY_MENU
 857  0087CD   A103                          cp       A, #3
 858  0087CF   2736                          jreq     keyarray_display_menu_3
 859  0087D1   A102                          cp       A, #2
 860  0087D3   276C                          jreq     keyarray_display_exit
 861                                   
 862                                   
 863                                                          ;LCD_SetCursor_Macro #0,#1
 864                         keyarray_display_menu_1:  
 865  0087D5   352300B4                      mov      CHAR_PRICE5, #'#'   
 866                                   
 867  0087D9   B69C                          ld       A, KEYBOARD_PRICE_BUF_S4
 868  0087DB   AB30                          add      A, #30H
 869  0087DD   B7B5                          ld       CHAR_PRICE4, A
 870                                   
 871  0087DF   B69D                          ld       A, KEYBOARD_PRICE_BUF_S3
 872  0087E1   AB30                          add      A, #30H
 873  0087E3   B7B6                          ld       CHAR_PRICE3, A
 874                                   
 875  0087E5   B69E                          ld       A, KEYBOARD_PRICE_BUF_S2
 876  0087E7   AB30                          add      A, #30H
 877  0087E9   B7B7                          ld       CHAR_PRICE2, A
 878                                   
 879  0087EB   352E00B8                      mov      CHAR_PRICE1, #'.'
 880                                                          ;ld A, KEYBOARD_BUF_S1
 881                                                          ;add A, #30H
 882                                                          ;ld CHAR_PRICE1, A
 883                                   
 884  0087EF   B6A0                          ld       A, KEYBOARD_PRICE_BUF_S0
 885  0087F1   AB30                          add      A, #30H
 886  0087F3   B7B9                          ld       CHAR_PRICE0, A
 887                                   
 888                                   
 889                                                          ;ld A, KEY_ARRAY_MENU
 890                                                          ;cp A, #1
 891                                                          ;jrne print_max_str_in_menu_2
 892                                   
 893                                   PrintStr #0,#1,#STR_PRICE
 893  0087F5   89                            pushw    X
 893  0087F6   35000000                      mov      LCD_VAR0, #0
 893  0087FA   35010001                      mov      LCD_VAR1, #1
 893  0087FE   AE00B4                        ldw      X, #STR_PRICE
 893  008801   CD82EA                        call     LCD_WriString
 893  008804   85                            popw     X
 894  008805   203A                          jra      keyarray_display_exit
 895                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 40  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 896                         keyarray_display_menu_3:  
 897  008807   355400BB                      mov      CHAR_THRESHOLD7, #'T'
 898  00880B   35A200BC                      mov      CHAR_THRESHOLD6, #0A2H
 899  00880F   35A300C2                      mov      CHAR_THRESHOLD0, #0A3H
 900                                   
 901  008813   B6A1                          ld       A, KEYBOARD_THRESHOLD_BUF_S4
 902  008815   AB30                          add      A, #30H
 903  008817   B7BD                          ld       CHAR_THRESHOLD5, A
 904                                   
 905  008819   B6A2                          ld       A, KEYBOARD_THRESHOLD_BUF_S3
 906  00881B   AB30                          add      A, #30H
 907  00881D   B7BE                          ld       CHAR_THRESHOLD4, A
 908                                   
 909  00881F   B6A3                          ld       A, KEYBOARD_THRESHOLD_BUF_S2
 910  008821   AB30                          add      A, #30H
 911  008823   B7BF                          ld       CHAR_THRESHOLD3, A
 912                                   
 913  008825   B6A4                          ld       A, KEYBOARD_THRESHOLD_BUF_S1
 914  008827   AB30                          add      A, #30H
 915  008829   B7C0                          ld       CHAR_THRESHOLD2, A
 916                                   
 917  00882B   B6A5                          ld       A, KEYBOARD_THRESHOLD_BUF_S0
 918  00882D   AB30                          add      A, #30H
 919  00882F   B7C1                          ld       CHAR_THRESHOLD1, A
 920                         
 921                         
 922                                   PrintStr #0,#1,#STR_THRESHOLD
 922  008831   89                            pushw    X
 922  008832   35000000                      mov      LCD_VAR0, #0
 922  008836   35010001                      mov      LCD_VAR1, #1
 922  00883A   AE00BB                        ldw      X, #STR_THRESHOLD
 922  00883D   CD82EA                        call     LCD_WriString
 922  008840   85                            popw     X
 923  008841                       
 924                                                          ;PrintStr #0, #1, #STR_MAX_MASS
 925                                   
 926                                                          ;mov KEYBOARD_BUF_S4, 
                                                                ;KEYBOARD_S4
 927                                                          ;mov KEYBOARD_BUF_S3, 
                                                                ;KEYBOARD_S3
 928                                                          ;mov KEYBOARD_BUF_S2, 
                                                                ;KEYBOARD_S2
 929                                                          ;mov KEYBOARD_BUF_S1, 
                                                                ;KEYBOARD_S1
 930                                                          ;mov KEYBOARD_BUF_S0, 
                                                                ;KEYBOARD_S0
 931                                   
 932                                                          ;ld A, #30
 933                                                          ;add A, KEYBOARD_BUF_S4
 934                                   
 935                                   
 936                                                          ; A = display counter, dec
 937                                                          ;ld A, KEYBOARD_DOT_OK
 938                                                          ;jreq keyarray_display_start
 939                                                          ;dec
 940                         
 941                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 41  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 942                         
 943                         keyarray_display_exit:  
 944                         
 945                         
 946  008841   85                            popw     X
 947  008842   84                            pop      A
 948  008843   86                            pop      CC
 949  008844   81                            ret      
 950                         
 951                         
 952                         
 953                         
 954                         
 955                         
 956                         ;***********************************************************
 957                         ;name   : TypingCursorFlash()
 958                         ;from   : 
 959                         ;go     : 
 960                         ;pins   :
 961                         ;           IN  : NULL
 962                         ;           OUT : NULL
 963                         ;***********************************************************
 964                         .TypingCursorFlash.W  
 965  008845   8A                            push     CC
 966  008846   88                            push     A
 967  008847   89                            pushw    X
 968                                   
 969  008848   B6A6                          ld       A, KEY_ARRAY_MENU
 970  00884A   A103                          cp       A, #3
 971  00884C   271F                          jreq     cursorflash_menu_3
 972                                   
 973                         cursorflash_menu_1:  
 974  00884E   35010001                      mov      LCD_VAR1, #1      ; y = 1, line 2
 975                                   
 976  008852   35050000                      mov      LCD_VAR0, #5      ; x = 4, col 5
 977  008856   B69B                          ld       A, KEYBOARD_DOT_OK
 978  008858   260E                          jrne     setcursor_ok
 979                                   
 980  00885A   B69A                          ld       A, {KEYBOARD_PTR+1}
 981  00885C   35030000                      mov      LCD_VAR0, #3
 982  008860   A103                          cp       A, #3         ; next =? CHAR_PRICE1
 983  008862   2604                          jrne     setcursor_ok
 984  008864   35040000                      mov      LCD_VAR0, #4
 985                         setcursor_ok:  
 986                                   
 987  008868   CD8318                        call     LCD_SetCursor
 988                                   
 989  00886B   200D                          jra      cursorflash_exit
 990                                   
 991                         cursorflash_menu_3:  
 992  00886D   35010001                      mov      LCD_VAR1, #1      ; y = 1, line 2
 993  008871   B69A                          ld       A, {KEYBOARD_PTR+1}
 994  008873   AB02                          add      A, #2
 995  008875   B700                          ld       LCD_VAR0, A
 996                                   
 997  008877   CD8318                        call     LCD_SetCursor
 998                                   
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 42  Assembler
                                               e:\stm8s\electronic_scale\key.asm

 999                         cursorflash_exit:  
1000  00887A   85                            popw     X
1001  00887B   84                            pop      A
1002  00887C   86                            pop      CC
1003  00887D   81                            ret      
1004                         
1005                         
1006                         ;***********************************************************
1007                         ;name   : Cal_Money()
1008                         ;fun    : 
1009                         ;params : 
1010                         ;         IN  : WEIGHT_QUOTIENT
1011                         ;               WEIGHT_REMAINDER
1012                         ;         OUT : 
1013                         ;***********************************************************
1014                         .Cal_Money.W  
1015  00887E   8A                            push     CC
1016  00887F   88                            push     A
1017  008880   89                            pushw    X
1018  008881   9089                          pushw    Y
1019                                   
1020                                                          ;-------------
1021                                                          ;   HIGH STACK
1022                                                          ;+2 YL(price*10)
1023                                                          ;+1 YH(price*10)
1024                                                          ;   LOW STACK
1025                                                          ;-------------
1026                                                          ; ----- get price ------
1027                                                          ; X <= price * 10
1028  008883   B69C                          ld       A, KEYBOARD_PRICE_BUF_S4
1029  008885   AE03E8                        ldw      X, #1000
1030  008888   CD8A5C                        call     TriMul
1031                                                          ; A:X
1032  00888B   1F01                          ldw      (1,SP), X
1033                         
1034                                   
1035  00888D   B69D                          ld       A, KEYBOARD_PRICE_BUF_S3
1036  00888F   AE0064                        ldw      X, #100
1037  008892   CD8A5C                        call     TriMul
1038                                                          ; A:X
1039  008895   72FB01                        addw     X, (1,SP)
1040  008898   1F01                          ldw      (1,SP), X
1041                                   
1042  00889A   B69E                          ld       A, KEYBOARD_PRICE_BUF_S2
1043  00889C   AE000A                        ldw      X, #10
1044  00889F   CD8A5C                        call     TriMul
1045  0088A2   72FB01                        addw     X, (1,SP)
1046  0088A5   1F01                          ldw      (1,SP), X
1047                                   
1048                                   
1049  0088A7   B6A0                          ld       A, KEYBOARD_PRICE_BUF_S0
1050  0088A9   5F                            clrw     X
1051  0088AA   97                            ld       XL, A
1052  0088AB   72FB01                        addw     X, (1,SP)
1053  0088AE   1F01                          ldw      (1,SP), X
1054                         
1055                         
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 43  Assembler
                                               e:\stm8s\electronic_scale\key.asm

1056                                                          ;-------------
1057                                                          ;   HIGH STACK
1058                                                          ;+2 YL(price*10)
1059                                                          ;+1 YH(price*10)
1060                                                          ;   LOW STACK
1061                                                          ;-------------
1062                                   
1063                                   
1064  0088B0   BE8B                          ldw      X, WEIGHT_QUOTIENT
1065  0088B2   90AE01F4                      ldw      Y, #500
1066  0088B6   65                            divw     X, Y
1067                                                          ; MAX WEIGHT = 20kg, X[max] = 
                                                                ;20kg / 500g = 40 
1068  0088B7   9F                            ld       A, XL
1069                                   
1070  0088B8   85                            popw     X
1071                                   
1072  0088B9   CD88C0                        call     MoneyHandle
1073                                   
1074                                   
1075                                   
1076                                   
1077                                   
1078                                                          ;popw Y
1079  0088BC   85                            popw     X
1080  0088BD   84                            pop      A
1081  0088BE   86                            pop      CC
1082                         
1083  0088BF   81                            ret      
1084                         
1085                         
1086                         ;***********************************************************
1087                         ;name   : MoneyHandle()
1088                         ;fun    : 
1089                         ;params : 
1090                         ;         IN  : X <= price * 10
1091                         ;               A <= weight/500g(quotient) < 40
1092                         ;               Y <= weight/500g(remainder) < 500
1093                         ;         OUT : money quotient: A:X
1094                         ;               money remainder:  Y
1095                         ;***********************************************************
1096                         .MoneyHandle.W  
1097  0088C0   8A                            push     CC
1098                                   
1099  0088C1   89                            pushw    X
1100                                   
1101  0088C2   3F8F                          clr      PRICE_MUL3
1102  0088C4   3F90                          clr      PRICE_MUL2
1103  0088C6   3F91                          clr      PRICE_MUL1
1104  0088C8   3F92                          clr      PRICE_MUL0
1105                                                          ; 
                                                                ;-------------------------------
                                                                ;--------------
1106                                                          ; integer money: 
1107                                   
1108                                                          ;-------------
1109                                                          ;   HIGH STACK
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 44  Assembler
                                               e:\stm8s\electronic_scale\key.asm

1110                                                          ;+2 XL(price)
1111                                                          ;+1 XH(price)
1112                                                          ;   LOW STACK
1113                                                          ;-------------
1114                                                          ;ldw X, X
1115                                                          ;ld A, A
1116  0088CA   CD8A5C                        call     TriMul
1117                                                          ; A:X
1118  0088CD   B790                          ld       PRICE_MUL2, A
1119  0088CF   BF91                          ldw      PRICE_MUL1, X
1120                                   
1121  0088D1   4B00                          push     #0
1122  0088D3   4B00                          push     #0
1123  0088D5   4B00                          push     #0
1124  0088D7   4B00                          push     #0
1125                                                          ;-------------
1126                                                          ;   HIGH STACK
1127                                                          ;+6 XL(price)
1128                                                          ;+5 XH(price)
1129                                                          ;+4 (1)
1130                                                          ;+3 (2)
1131                                                          ;+2 (3)
1132                                                          ;+1 (4)
1133                                                          ;   LOW STACK
1134                                                          ;-------------
1135                                                          ;ldw Y, Y
1136  0088D9   1E05                          ldw      X, (5,SP)
1137  0088DB   CD8AA7                        call     QuadMul
1138                                                          ; X:Y
1139  0088DE   1F01                          ldw      (1,SP), X
1140  0088E0   1703                          ldw      (3,SP), Y
1141                                                          ; 500 * 9999 < 2^24
1142                                   
1143                                   
1144                                                          ; 
                                                                ;-------------------------------
                                                                ;--------------
1145                                                          ; remainder money:   Y <= 
                                                                ;remainder 
1146                                                          ; (Y / 500g < 1)
1147                                                          ; Y / 500g * price  = (Y * 
                                                                ;price)  / 500g
1148  0088E2   7B02                          ld       A, (2,SP)
1149  0088E4   1E03                          ldw      X, (3,SP)
1150  0088E6   90AE01F4                      ldw      Y, #500
1151  0088EA   CD8B11                        call     TriDiv
1152                                                          ; A:X <= quotient, Y <= 
                                                                ;remainder
1153                                   
1154  0088ED   72BB0091                      addw     X, PRICE_MUL1
1155  0088F1   B990                          adc      A, PRICE_MUL2
1156  0088F3   88                            push     A
1157  0088F4   BF91                          ldw      PRICE_MUL1, X
1158  0088F6   B790                          ld       PRICE_MUL2, A
1159  0088F8   B68F                          ld       A, PRICE_MUL3
1160  0088FA   84                            pop      A
1161  0088FB   A900                          adc      A, #0
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 45  Assembler
                                               e:\stm8s\electronic_scale\key.asm

1162  0088FD   B78F                          ld       PRICE_MUL3, A
1163                                   
1164                                   
1165                                                          ;-------------
1166                                                          ;   HIGH STACK
1167                                                          ;+6 XL(price)
1168                                                          ;+5 XH(price)
1169                                                          ;+4 (1)
1170                                                          ;+3 (2)
1171                                                          ;+2 (3)
1172                                                          ;+1 (4)
1173                                                          ;   LOW STACK
1174                                                          ;-------------
1175                                                          ;-------------
1176                                                          ; (WEIGHT REMAINDER/10) / 500 * 
                                                                ;price * 10
1177                                                          ; ((WEIGHT REMAINDER * price * 
                                                                ;10) / 500) / 10
1178                                                          ; + remainder
1179                                   
1180                                                          ; (WEIGHT REMAINDER * price * 
                                                                ;10)
1181                                                          ; WEIGHT REMAINDER * (5,SP)
1182  0088FF   BE8D                          ldw      X, WEIGHT_REMAINDER
1183  008901   1605                          ldw      Y, (5,SP)
1184  008903   CD8AA7                        call     QuadMul
1185                                                          ; X:Y
1186                                                          ; WEIGHT REMAINDER * price * 10 
                                                                ;
1187                                                          ; <= 9 * 999.9 * 10 = 89991 < 
                                                                ;2^24
1188  008906   51                            exgw     X, Y
1189  008907   909F                          ld       A, YL
1190                                   
1191                                                          ; A:X
1192                                                          ; / 5000
1193  008909   90AE1388                      ldw      Y, #5000
1194  00890D   CD8B11                        call     TriDiv
1195                                                          ; <= 89991 / 5000 < 18
1196                                                          ; A:X   (A = 0x00)
1197  008910   72BB0091                      addw     X, PRICE_MUL1
1198  008914   A900                          adc      A, #0
1199  008916   BF91                          ldw      PRICE_MUL1, X
1200  008918   BB90                          add      A, PRICE_MUL2
1201  00891A   B790                          ld       PRICE_MUL2, A
1202                                                          ; 
1203                                   
1204                                   
1205  00891C   85                            popw     X
1206  00891D   85                            popw     X
1207  00891E   85                            popw     X
1208                                   
1209                                   
1210                                                          ; / 10
1211  00891F   B690                          ld       A, PRICE_MUL2
1212  008921   BE91                          ldw      X, PRICE_MUL1
1213  008923   90AE000A                      ldw      Y, #10
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 46  Assembler
                                               e:\stm8s\electronic_scale\key.asm

1214  008927   CD8B11                        call     TriDiv
1215                                                          ; A:X <= quotient, Y <= 
                                                                ;remainder
1216                                   
1217                                   
1218                                   
1219  00892A   CD892F                        call     MoneyDisplay
1220                         
1221                                   
1222                                   
1223  00892D   86                            pop      CC
1224  00892E   81                            ret      
1225                                   
1226                                   
1227                         ;***********************************************************
1228                         ;name   : MoneyDisplay()
1229                         ;fun    : 
1230                         ;params : 
1231                         ;         IN  : money quotient: A:X - (A = 0x00)
1232                         ;               money remainder:  Y
1233                         ;         OUT :  
1234                         ;***********************************************************
1235                         .MoneyDisplay.W  
1236  00892F   8A                            push     CC
1237  008930   9089                          pushw    Y
1238                                   
1239  008932   355C00C4                      mov      CHAR_MONEY7, #5CH         ;0x5C => 
1240                                   
1241  008936   90AE2710                      ldw      Y, #10000
1242  00893A   65                            divw     X, Y
1243                                   
1244  00893B   1C0030                        addw     X, #30H
1245  00893E   9F                            ld       A, XL
1246  00893F   B7C5                          ld       CHAR_MONEY6, A
1247                                   
1248  008941   93                            ldw      X, Y
1249  008942   90AE03E8                      ldw      Y, #1000
1250  008946   65                            divw     X, Y
1251                                   
1252  008947   1C0030                        addw     X, #30H
1253  00894A   9F                            ld       A, XL
1254  00894B   B7C6                          ld       CHAR_MONEY5, A
1255                                   
1256  00894D   93                            ldw      X, Y
1257  00894E   90AE0064                      ldw      Y, #100
1258  008952   65                            divw     X, Y
1259                                   
1260  008953   1C0030                        addw     X, #30H
1261  008956   9F                            ld       A, XL
1262  008957   B7C7                          ld       CHAR_MONEY4, A
1263                                   
1264  008959   93                            ldw      X, Y
1265  00895A   90AE000A                      ldw      Y, #10
1266  00895E   65                            divw     X, Y
1267                                   
1268  00895F   1C0030                        addw     X, #30H
1269  008962   9F                            ld       A, XL
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 47  Assembler
                                               e:\stm8s\electronic_scale\key.asm

1270  008963   B7C8                          ld       CHAR_MONEY3, A
1271                                   
1272                         
1273  008965   72A90030                      addw     Y, #30H
1274  008969   909F                          ld       A, YL
1275  00896B   B7C9                          ld       CHAR_MONEY2, A
1276                                   
1277                                   
1278  00896D   352E00CA                      mov      CHAR_MONEY1, #'.'
1279                                   
1280                                   
1281  008971   9085                          popw     Y
1282  008973   72A90030                      addw     Y, #30H
1283  008977   909F                          ld       A, YL
1284  008979   B7CB                          ld       CHAR_MONEY0, A
1285                                   
1286                                   
1287  00897B   B6A6                          ld       A, KEY_ARRAY_MENU
1288  00897D   A101                          cp       A, #1
1289  00897F   2600                          jrne     moneydisplay_exit
1290                                                          ;PrintStr #8,#1,#STR_MONEY
1291                                   
1292                                                          ;
1293                         moneydisplay_exit:  
1294                         
1295  008981   86                            pop      CC
1296  008982   81                            ret      
1297                         
1298                         
1299                         
1300                         
1301  008983                                 end      
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 48  Assembler
                                               e:\stm8s\electronic_scale\key.asm

Symbol Name                       Value     Call       Type  Scope      Rel.  Line  Privacy  Segment   Size  Bytes File

AWU_CSR                               50F0         no  WORD  Internal   ABS    170  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
AWU_APR                               50F1         no  WORD  Internal   ABS    172  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
AWU_TBR                               50F2         no  WORD  Internal   ABS    174  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB0RH                             53E0         no  WORD  Internal   ABS    427  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB0RL                             53E1         no  WORD  Internal   ABS    429  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB1RH                             53E2         no  WORD  Internal   ABS    431  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB1RL                             53E3         no  WORD  Internal   ABS    433  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB2RH                             53E4         no  WORD  Internal   ABS    435  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB2RL                             53E5         no  WORD  Internal   ABS    437  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB3RH                             53E6         no  WORD  Internal   ABS    439  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB3RL                             53E7         no  WORD  Internal   ABS    441  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB4RH                             53E8         no  WORD  Internal   ABS    443  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB4RL                             53E9         no  WORD  Internal   ABS    445  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB5RH                             53EA         no  WORD  Internal   ABS    447  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB5RL                             53EB         no  WORD  Internal   ABS    449  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB6RH                             53EC         no  WORD  Internal   ABS    451  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB6RL                             53ED         no  WORD  Internal   ABS    453  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB7RH                             53EE         no  WORD  Internal   ABS    455  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB7RL                             53EF         no  WORD  Internal   ABS    457  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB8RH                             53F0         no  WORD  Internal   ABS    459  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB8RL                             53F1         no  WORD  Internal   ABS    461  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB9RH                             53F2         no  WORD  Internal   ABS    463  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DB9RL                             53F3         no  WORD  Internal   ABS    465  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_CSR                               5400         no  WORD  Internal   ABS    467  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_CR1                               5401         no  WORD  Internal   ABS    469  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_CR2                               5402         no  WORD  Internal   ABS    471  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_CR3                               5403         no  WORD  Internal   ABS    473  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DRH                               5404         no  WORD  Internal   ABS    475  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_DRL                               5405         no  WORD  Internal   ABS    477  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_TDRH                              5406         no  WORD  Internal   ABS    479  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_TDRL                              5407         no  WORD  Internal   ABS    481  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_HTRH                              5408         no  WORD  Internal   ABS    483  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_HTRL                              5409         no  WORD  Internal   ABS    485  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_LTRH                              540A         no  WORD  Internal   ABS    487  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_LTRL                              540B         no  WORD  Internal   ABS    489  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_AWSRH                             540C         no  WORD  Internal   ABS    491  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_AWSRL                             540D         no  WORD  Internal   ABS    493  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_AWCRH                             540E         no  WORD  Internal   ABS    495  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_AWCRL                             540F         no  WORD  Internal   ABS    497  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ADC_COUNTER                             03         no  BYTE  Internal   ABS     12  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SUM                                 04         no  BYTE  Internal   ABS     16  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SUM0                                07         no  BYTE  Internal   ABS     17  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SUM1                                06         no  BYTE  Internal   ABS     18  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SUM2                                05         no  BYTE  Internal   ABS     19  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SUM3                                04         no  BYTE  Internal   ABS     20  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_AVG                                 08         no  BYTE  Internal   ABS     22  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_AVG0                                0B         no  BYTE  Internal   ABS     23  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_AVG1                                0A         no  BYTE  Internal   ABS     24  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_AVG2                                09         no  BYTE  Internal   ABS     25  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_AVG3                                08         no  BYTE  Internal   ABS     26  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_STORE                               0C         no  BYTE  Internal   ABS     28  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S00                                 0E         no  BYTE  Internal   ABS     30  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S01                                 0D         no  BYTE  Internal   ABS     31  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S02                                 0C         no  BYTE  Internal   ABS     32  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S10                                 11         no  BYTE  Internal   ABS     34  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 49  Assembler
                                               e:\stm8s\electronic_scale\key.asm

ADC_S11                                 10         no  BYTE  Internal   ABS     35  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S12                                 0F         no  BYTE  Internal   ABS     36  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S20                                 14         no  BYTE  Internal   ABS     38  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S21                                 13         no  BYTE  Internal   ABS     39  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S22                                 12         no  BYTE  Internal   ABS     40  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S30                                 17         no  BYTE  Internal   ABS     42  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S31                                 16         no  BYTE  Internal   ABS     43  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S32                                 15         no  BYTE  Internal   ABS     44  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S40                                 1A         no  BYTE  Internal   ABS     46  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S41                                 19         no  BYTE  Internal   ABS     47  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S42                                 18         no  BYTE  Internal   ABS     48  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S50                                 1D         no  BYTE  Internal   ABS     50  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S51                                 1C         no  BYTE  Internal   ABS     51  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S52                                 1B         no  BYTE  Internal   ABS     52  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S60                                 20         no  BYTE  Internal   ABS     54  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S61                                 1F         no  BYTE  Internal   ABS     55  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S62                                 1E         no  BYTE  Internal   ABS     56  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S70                                 23         no  BYTE  Internal   ABS     58  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S71                                 22         no  BYTE  Internal   ABS     59  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S72                                 21         no  BYTE  Internal   ABS     60  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S80                                 26         no  BYTE  Internal   ABS     62  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S81                                 25         no  BYTE  Internal   ABS     63  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S82                                 24         no  BYTE  Internal   ABS     64  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S90                                 29         no  BYTE  Internal   ABS     66  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S91                                 28         no  BYTE  Internal   ABS     67  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_S92                                 27         no  BYTE  Internal   ABS     68  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SA0                                 2C         no  BYTE  Internal   ABS     70  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SA1                                 2B         no  BYTE  Internal   ABS     71  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SA2                                 2A         no  BYTE  Internal   ABS     72  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SB0                                 2F         no  BYTE  Internal   ABS     74  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SB1                                 2E         no  BYTE  Internal   ABS     75  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SB2                                 2D         no  BYTE  Internal   ABS     76  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SC0                                 32         no  BYTE  Internal   ABS     78  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SC1                                 31         no  BYTE  Internal   ABS     79  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SC2                                 30         no  BYTE  Internal   ABS     80  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SD0                                 35         no  BYTE  Internal   ABS     82  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SD1                                 34         no  BYTE  Internal   ABS     83  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SD2                                 33         no  BYTE  Internal   ABS     84  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SE0                                 38         no  BYTE  Internal   ABS     86  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SE1                                 37         no  BYTE  Internal   ABS     87  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SE2                                 36         no  BYTE  Internal   ABS     88  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SF0                                 3B         no  BYTE  Internal   ABS     90  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SF1                                 3A         no  BYTE  Internal   ABS     91  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SF2                                 39         no  BYTE  Internal   ABS     92  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SG0                                 3E         no  BYTE  Internal   ABS     94  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SG1                                 3D         no  BYTE  Internal   ABS     95  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SG2                                 3C         no  BYTE  Internal   ABS     96  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SH0                                 41         no  BYTE  Internal   ABS     98  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SH1                                 40         no  BYTE  Internal   ABS     99  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SH2                                 3F         no  BYTE  Internal   ABS    100  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SI0                                 44         no  BYTE  Internal   ABS    102  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SI1                                 43         no  BYTE  Internal   ABS    103  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SI2                                 42         no  BYTE  Internal   ABS    104  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SJ0                                 47         no  BYTE  Internal   ABS    106  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SJ1                                 46         no  BYTE  Internal   ABS    107  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SJ2                                 45         no  BYTE  Internal   ABS    108  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SK0                                 4A         no  BYTE  Internal   ABS    110  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 50  Assembler
                                               e:\stm8s\electronic_scale\key.asm

ADC_SK1                                 49         no  BYTE  Internal   ABS    111  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SK2                                 48         no  BYTE  Internal   ABS    112  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SL0                                 4D         no  BYTE  Internal   ABS    114  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SL1                                 4C         no  BYTE  Internal   ABS    115  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SL2                                 4B         no  BYTE  Internal   ABS    116  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SM0                                 50         no  BYTE  Internal   ABS    118  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SM1                                 4F         no  BYTE  Internal   ABS    119  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SM2                                 4E         no  BYTE  Internal   ABS    120  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SN0                                 53         no  BYTE  Internal   ABS    122  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SN1                                 52         no  BYTE  Internal   ABS    123  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SN2                                 51         no  BYTE  Internal   ABS    124  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SO0                                 56         no  BYTE  Internal   ABS    126  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SO1                                 55         no  BYTE  Internal   ABS    127  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SO2                                 54         no  BYTE  Internal   ABS    128  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SP0                                 59         no  BYTE  Internal   ABS    130  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SP1                                 58         no  BYTE  Internal   ABS    131  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SP2                                 57         no  BYTE  Internal   ABS    132  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SQ0                                 5C         no  BYTE  Internal   ABS    134  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SQ1                                 5B         no  BYTE  Internal   ABS    135  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SQ2                                 5A         no  BYTE  Internal   ABS    136  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SR0                                 5F         no  BYTE  Internal   ABS    138  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SR1                                 5E         no  BYTE  Internal   ABS    139  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SR2                                 5D         no  BYTE  Internal   ABS    140  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SS0                                 62         no  BYTE  Internal   ABS    142  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SS1                                 61         no  BYTE  Internal   ABS    143  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SS2                                 60         no  BYTE  Internal   ABS    144  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_ST0                                 65         no  BYTE  Internal   ABS    146  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_ST1                                 64         no  BYTE  Internal   ABS    147  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_ST2                                 63         no  BYTE  Internal   ABS    148  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SU0                                 68         no  BYTE  Internal   ABS    150  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SU1                                 67         no  BYTE  Internal   ABS    151  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SU2                                 66         no  BYTE  Internal   ABS    152  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SV0                                 6B         no  BYTE  Internal   ABS    154  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SV1                                 6A         no  BYTE  Internal   ABS    155  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SV2                                 69         no  BYTE  Internal   ABS    156  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SW0                                 6E         no  BYTE  Internal   ABS    158  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SW1                                 6D         no  BYTE  Internal   ABS    159  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SW2                                 6C         no  BYTE  Internal   ABS    160  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SX0                                 71         no  BYTE  Internal   ABS    162  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SX1                                 70         no  BYTE  Internal   ABS    163  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SX2                                 6F         no  BYTE  Internal   ABS    164  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SY0                                 74         no  BYTE  Internal   ABS    166  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SY1                                 73         no  BYTE  Internal   ABS    167  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SY2                                 72         no  BYTE  Internal   ABS    168  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_THRESHOLD_QUOTIENT                  75         no  BYTE  Internal   ABS    170  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_THRESHOLD_QUOTIENT1                 75         no  BYTE  Internal   ABS    171  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_THRESHOLD_QUOTIENT0                 76         no  BYTE  Internal   ABS    172  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_MAX_QUOTIENT                        77         no  BYTE  Internal   ABS    174  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_MAX_QUOTIENT_S1                     77         no  BYTE  Internal   ABS    175  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_MAX_QUOTIENT_S0                     78         no  BYTE  Internal   ABS    176  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_MAX_REMAINDER                       79         no  BYTE  Internal   ABS    178  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_MAX_REMAINDER_S1                    79         no  BYTE  Internal   ABS    179  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_MAX_REMAINDER_S0                    7A         no  BYTE  Internal   ABS    180  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_NEXT_PTR                            7B         no  BYTE  Internal   ABS    185  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_SLOPE                               7D         no  BYTE  Internal   ABS    190  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ADC_Delay                             8A1A         no  WORD  Internal   ABS      9  private  text         0     0  e:\stm8s\electronic_scale\common.inc

STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 51  Assembler
                                               e:\stm8s\electronic_scale\key.asm

BEEP_CSR                              50F3         no  WORD  Internal   ABS    179  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc

CLK_ICKR                              50C0         no  WORD  Internal   ABS    125  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_ECKR                              50C1         no  WORD  Internal   ABS    127  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_CMSR                              50C3         no  WORD  Internal   ABS    129  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_SWR                               50C4         no  WORD  Internal   ABS    131  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_SWCR                              50C5         no  WORD  Internal   ABS    133  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_CKDIVR                            50C6         no  WORD  Internal   ABS    135  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_PCKENR1                           50C7         no  WORD  Internal   ABS    137  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_CSSR                              50C8         no  WORD  Internal   ABS    139  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_CCOR                              50C9         no  WORD  Internal   ABS    141  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_PCKENR2                           50CA         no  WORD  Internal   ABS    143  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_CANCCR                            50CB         no  WORD  Internal   ABS    145  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_HSITRIMR                          50CC         no  WORD  Internal   ABS    147  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CLK_SWIMCCR                           50CD         no  WORD  Internal   ABS    149  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CFG_GCR                               7F60         no  WORD  Internal   ABS    502  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
CHAR_MASS9                              A8         no  BYTE  Internal   ABS    253  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS8                              A9         no  BYTE  Internal   ABS    254  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS7                              AA         no  BYTE  Internal   ABS    255  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS6                              AB         no  BYTE  Internal   ABS    256  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS5                              AC         no  BYTE  Internal   ABS    257  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS4                              AD         no  BYTE  Internal   ABS    258  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS3                              AE         no  BYTE  Internal   ABS    259  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS2                              AF         no  BYTE  Internal   ABS    260  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS1                              B0         no  BYTE  Internal   ABS    261  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS0                              B1         no  BYTE  Internal   ABS    262  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MASS_1                             B2         no  BYTE  Internal   ABS    263  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_PRICE5                             B4         no  BYTE  Internal   ABS    268  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_PRICE4                             B5         no  BYTE  Internal   ABS    269  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_PRICE3                             B6         no  BYTE  Internal   ABS    270  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_PRICE2                             B7         no  BYTE  Internal   ABS    271  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_PRICE1                             B8         no  BYTE  Internal   ABS    272  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_PRICE0                             B9         no  BYTE  Internal   ABS    273  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD7                         BB         no  BYTE  Internal   ABS    276  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD6                         BC         no  BYTE  Internal   ABS    277  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD5                         BD         no  BYTE  Internal   ABS    278  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD4                         BE         no  BYTE  Internal   ABS    279  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD3                         BF         no  BYTE  Internal   ABS    280  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD2                         C0         no  BYTE  Internal   ABS    281  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD1                         C1         no  BYTE  Internal   ABS    282  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_THRESHOLD0                         C2         no  BYTE  Internal   ABS    283  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY7                             C4         no  BYTE  Internal   ABS    288  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY6                             C5         no  BYTE  Internal   ABS    289  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY5                             C6         no  BYTE  Internal   ABS    290  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY4                             C7         no  BYTE  Internal   ABS    291  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY3                             C8         no  BYTE  Internal   ABS    292  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY2                             C9         no  BYTE  Internal   ABS    293  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY1                             CA         no  BYTE  Internal   ABS    294  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MONEY0                             CB         no  BYTE  Internal   ABS    295  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS9                          CD         no  BYTE  Internal   ABS    301  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS8                          CE         no  BYTE  Internal   ABS    302  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS7                          CF         no  BYTE  Internal   ABS    303  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS6                          D0         no  BYTE  Internal   ABS    304  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS5                          D1         no  BYTE  Internal   ABS    305  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS4                          D2         no  BYTE  Internal   ABS    306  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS3                          D3         no  BYTE  Internal   ABS    307  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS2                          D4         no  BYTE  Internal   ABS    308  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 52  Assembler
                                               e:\stm8s\electronic_scale\key.asm

CHAR_MAX_MASS1                          D5         no  BYTE  Internal   ABS    309  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS0                          D6         no  BYTE  Internal   ABS    310  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CHAR_MAX_MASS_1                         D7         no  BYTE  Internal   ABS    311  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
CPU_Delay_1us                         89E9         no  WORD  Internal   ABS     11  private  text         0     0  e:\stm8s\electronic_scale\common.inc
Cal_Money                             887E         no  WORD  Internal   ABS   1014  public   text        66     0  e:\stm8s\electronic_scale\key.inc

EXTI_CR1                              50A0         no  WORD  Internal   ABS    113  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
EXTI_CR2                              50A1         no  WORD  Internal   ABS    115  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
EMPTY_LINE                            816D         no  WORD  Internal   ABS     53  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc

FLASH_CR1                             505A         no  WORD  Internal   ABS     94  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
FLASH_CR2                             505B         no  WORD  Internal   ABS     96  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
FLASH_NCR2                            505C         no  WORD  Internal   ABS     98  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
FLASH_FPR                             505D         no  WORD  Internal   ABS    100  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
FLASH_NFPR                            505E         no  WORD  Internal   ABS    102  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
FLASH_IAPSR                           505F         no  WORD  Internal   ABS    104  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
FLASH_PUKR                            5062         no  WORD  Internal   ABS    106  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
FLASH_DUKR                            5064         no  WORD  Internal   ABS    108  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc

IWDG_KR                               50E0         no  WORD  Internal   ABS    161  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
IWDG_PR                               50E1         no  WORD  Internal   ABS    163  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
IWDG_RLR                              50E2         no  WORD  Internal   ABS    165  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_CR1                               5210         no  WORD  Internal   ABS    203  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_CR2                               5211         no  WORD  Internal   ABS    205  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_FREQR                             5212         no  WORD  Internal   ABS    207  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_OARL                              5213         no  WORD  Internal   ABS    209  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_OARH                              5214         no  WORD  Internal   ABS    211  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_DR                                5216         no  WORD  Internal   ABS    213  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_SR1                               5217         no  WORD  Internal   ABS    215  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_SR2                               5218         no  WORD  Internal   ABS    217  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_SR3                               5219         no  WORD  Internal   ABS    219  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_ITR                               521A         no  WORD  Internal   ABS    221  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_CCRL                              521B         no  WORD  Internal   ABS    223  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_CCRH                              521C         no  WORD  Internal   ABS    225  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_TRISER                            521D         no  WORD  Internal   ABS    227  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
I2C_PECR                              521E         no  WORD  Internal   ABS    229  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ITC_SPR1                              7F70         no  WORD  Internal   ABS    507  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ITC_SPR2                              7F71         no  WORD  Internal   ABS    509  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ITC_SPR3                              7F72         no  WORD  Internal   ABS    511  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ITC_SPR4                              7F73         no  WORD  Internal   ABS    513  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ITC_SPR5                              7F74         no  WORD  Internal   ABS    515  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ITC_SPR6                              7F75         no  WORD  Internal   ABS    517  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
ITC_SPR7                              7F76         no  WORD  Internal   ABS    519  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc

KEYDOWN_FLAG                            93         no  BYTE  Internal   ABS    220  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_STORE                          94         no  BYTE  Internal   ABS    223  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_S4                             94         no  BYTE  Internal   ABS    225  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_S3                             95         no  BYTE  Internal   ABS    226  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_S2                             96         no  BYTE  Internal   ABS    227  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_S1                             97         no  BYTE  Internal   ABS    228  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_S0                             98         no  BYTE  Internal   ABS    229  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_PTR                            99         no  BYTE  Internal   ABS    230  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_DOT_OK                         9B         no  BYTE  Internal   ABS    232  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_PRICE_BUF_S4                   9C         no  BYTE  Internal   ABS    234  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_PRICE_BUF_S3                   9D         no  BYTE  Internal   ABS    235  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_PRICE_BUF_S2                   9E         no  BYTE  Internal   ABS    236  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_PRICE_BUF_S1                   9F         no  BYTE  Internal   ABS    237  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 53  Assembler
                                               e:\stm8s\electronic_scale\key.asm

KEYBOARD_PRICE_BUF_S0                   A0         no  BYTE  Internal   ABS    238  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_THRESHOLD_BUF_S4               A1         no  BYTE  Internal   ABS    241  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_THRESHOLD_BUF_S3               A2         no  BYTE  Internal   ABS    242  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_THRESHOLD_BUF_S2               A3         no  BYTE  Internal   ABS    243  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_THRESHOLD_BUF_S1               A4         no  BYTE  Internal   ABS    244  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEYBOARD_THRESHOLD_BUF_S0               A5         no  BYTE  Internal   ABS    245  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEY_ARRAY_MENU                          A6         no  BYTE  Internal   ABS    248  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KEY_TYPING_FLAG                         A7         no  BYTE  Internal   ABS    249  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
KeyDelay                              8A0C         no  WORD  Internal   ABS     10  private  text         0     0  e:\stm8s\electronic_scale\common.inc
KeyZero_Init                          8397         no  WORD  Internal   ABS     20  public   text        37     0  e:\stm8s\electronic_scale\key.inc
KeyZero_Handler                   000083BC  interrupt  LONG  Internal   ABS     57  public   text        17     0  e:\stm8s\electronic_scale\key.inc
KeyArray_Init                         83D3         no  WORD  Internal   ABS     91  public   text        81     0  e:\stm8s\electronic_scale\key.inc
KeyArray_Scan                         8442         no  WORD  Internal   ABS    225  public   text         3     0  e:\stm8s\electronic_scale\key.inc
KeyArray_Handler                  00008424  interrupt  LONG  Internal   ABS    161  public   text        16     0  e:\stm8s\electronic_scale\key.inc
KeyArray_Settle                       86D7         no  WORD  Internal   ABS    597  public   text         8     0  e:\stm8s\electronic_scale\key.inc
KeyArray_Display                      87C8         no  WORD  Internal   ABS    851  public   text        13     0  e:\stm8s\electronic_scale\key.inc

LCD_VAR0                                00         no  BYTE  Internal   ABS      8  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
LCD_VAR1                                01         no  BYTE  Internal   ABS      9  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
LCD_VAR2                                02         no  BYTE  Internal   ABS     10  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
LCD_Delay                             89FF         no  WORD  Internal   ABS      8  private  text         0     0  e:\stm8s\electronic_scale\common.inc
LCD_Init                              817E         no  WORD  Internal   ABS     43  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc
LCD_WriChar                           82D2         no  WORD  Internal   ABS     44  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc
LCD_WriCMD                            832D         no  WORD  Internal   ABS     45  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc
LCD_WriData                           8346         no  WORD  Internal   ABS     46  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc
LCD_SerData                           835F         no  WORD  Internal   ABS     47  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc
LCD_WriString                         82EA         no  WORD  Internal   ABS     48  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc
LCD_SetCursor                         8318         no  WORD  Internal   ABS     49  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc
LCD_InitCustom                        823B         no  WORD  Internal   ABS     50  private  text         0     0  e:\stm8s\electronic_scale\lcd.inc

MassDivider                           8A27         no  WORD  Internal   ABS     12  private  text         0     0  e:\stm8s\electronic_scale\common.inc
MoneyHandle                           88C0         no  WORD  Internal   ABS   1096  public   text       111     0  e:\stm8s\electronic_scale\key.inc
MoneyDisplay                          892F         no  WORD  Internal   ABS   1235  public   text        82     0  -

NET_ADC                                 83         no  BYTE  Internal   ABS    198  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_ADC0                                86         no  BYTE  Internal   ABS    199  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_ADC1                                85         no  BYTE  Internal   ABS    200  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_ADC2                                84         no  BYTE  Internal   ABS    201  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_ADC3                                83         no  BYTE  Internal   ABS    202  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_BUF                                 87         no  BYTE  Internal   ABS    204  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_BUF3                                87         no  BYTE  Internal   ABS    205  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_BUF2                                88         no  BYTE  Internal   ABS    206  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_BUF1                                89         no  BYTE  Internal   ABS    207  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
NET_BUF0                                8A         no  BYTE  Internal   ABS    208  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc

PA_ODR                                5000         no  WORD  Internal   ABS     16  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PA_IDR                                5001         no  WORD  Internal   ABS     18  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PA_DDR                                5002         no  WORD  Internal   ABS     20  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PA_CR1                                5003         no  WORD  Internal   ABS     22  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PA_CR2                                5004         no  WORD  Internal   ABS     24  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PB_ODR                                5005         no  WORD  Internal   ABS     29  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PB_IDR                                5006         no  WORD  Internal   ABS     31  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PB_DDR                                5007         no  WORD  Internal   ABS     33  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PB_CR1                                5008         no  WORD  Internal   ABS     35  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PB_CR2                                5009         no  WORD  Internal   ABS     37  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PC_ODR                                500A         no  WORD  Internal   ABS     42  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 54  Assembler
                                               e:\stm8s\electronic_scale\key.asm

PC_IDR                                500B         no  WORD  Internal   ABS     44  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PC_DDR                                500C         no  WORD  Internal   ABS     46  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PC_CR1                                500D         no  WORD  Internal   ABS     48  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PC_CR2                                500E         no  WORD  Internal   ABS     50  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PD_ODR                                500F         no  WORD  Internal   ABS     55  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PD_IDR                                5010         no  WORD  Internal   ABS     57  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PD_DDR                                5011         no  WORD  Internal   ABS     59  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PD_CR1                                5012         no  WORD  Internal   ABS     61  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PD_CR2                                5013         no  WORD  Internal   ABS     63  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PE_ODR                                5014         no  WORD  Internal   ABS     68  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PE_IDR                                5015         no  WORD  Internal   ABS     70  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PE_DDR                                5016         no  WORD  Internal   ABS     72  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PE_CR1                                5017         no  WORD  Internal   ABS     74  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PE_CR2                                5018         no  WORD  Internal   ABS     76  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PF_ODR                                5019         no  WORD  Internal   ABS     81  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PF_IDR                                501A         no  WORD  Internal   ABS     83  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PF_DDR                                501B         no  WORD  Internal   ABS     85  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PF_CR1                                501C         no  WORD  Internal   ABS     87  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PF_CR2                                501D         no  WORD  Internal   ABS     89  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
PRICE_MUL3                              8F         no  BYTE  Internal   ABS    215  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
PRICE_MUL2                              90         no  BYTE  Internal   ABS    216  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
PRICE_MUL1                              91         no  BYTE  Internal   ABS    217  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
PRICE_MUL0                              92         no  BYTE  Internal   ABS    218  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
PriceAlign                            8767         no  WORD  Internal   ABS    740  public   text        28     0  e:\stm8s\electronic_scale\key.inc

QuadMul                               8AA7         no  WORD  Internal   ABS     16  private  text         0     0  e:\stm8s\electronic_scale\common.inc

RST_SR                                50B3         no  WORD  Internal   ABS    120  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc

SPI_CR1                               5200         no  WORD  Internal   ABS    184  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
SPI_CR2                               5201         no  WORD  Internal   ABS    186  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
SPI_ICR                               5202         no  WORD  Internal   ABS    188  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
SPI_SR                                5203         no  WORD  Internal   ABS    190  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
SPI_DR                                5204         no  WORD  Internal   ABS    192  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
SPI_CRCPR                             5205         no  WORD  Internal   ABS    194  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
SPI_RXCRCR                            5206         no  WORD  Internal   ABS    196  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
SPI_TXCRCR                            5207         no  WORD  Internal   ABS    198  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
STR_MASS                                A8         no  BYTE  Internal   ABS    252  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STR_PRICE                               B4         no  BYTE  Internal   ABS    267  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STR_THRESHOLD                           BB         no  BYTE  Internal   ABS    275  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STR_MONEY                               C4         no  BYTE  Internal   ABS    287  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
STR_MAX_MASS                            CD         no  BYTE  Internal   ABS    298  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc

TIM1_CR1                              5250         no  WORD  Internal   ABS    261  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CR2                              5251         no  WORD  Internal   ABS    263  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_SMCR                             5252         no  WORD  Internal   ABS    265  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_ETR                              5253         no  WORD  Internal   ABS    267  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_IER                              5254         no  WORD  Internal   ABS    269  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_SR1                              5255         no  WORD  Internal   ABS    271  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_SR2                              5256         no  WORD  Internal   ABS    273  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_EGR                              5257         no  WORD  Internal   ABS    275  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCMR1                            5258         no  WORD  Internal   ABS    277  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCMR2                            5259         no  WORD  Internal   ABS    279  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCMR3                            525A         no  WORD  Internal   ABS    281  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCMR4                            525B         no  WORD  Internal   ABS    283  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCER1                            525C         no  WORD  Internal   ABS    285  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCER2                            525D         no  WORD  Internal   ABS    287  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 55  Assembler
                                               e:\stm8s\electronic_scale\key.asm

TIM1_CNTRH                            525E         no  WORD  Internal   ABS    289  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CNTRL                            525F         no  WORD  Internal   ABS    291  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_PSCRH                            5260         no  WORD  Internal   ABS    293  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_PSCRL                            5261         no  WORD  Internal   ABS    295  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_ARRH                             5262         no  WORD  Internal   ABS    297  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_ARRL                             5263         no  WORD  Internal   ABS    299  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_RCR                              5264         no  WORD  Internal   ABS    301  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR1H                            5265         no  WORD  Internal   ABS    303  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR1L                            5266         no  WORD  Internal   ABS    305  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR2H                            5267         no  WORD  Internal   ABS    307  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR2L                            5268         no  WORD  Internal   ABS    309  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR3H                            5269         no  WORD  Internal   ABS    311  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR3L                            526A         no  WORD  Internal   ABS    313  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR4H                            526B         no  WORD  Internal   ABS    315  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_CCR4L                            526C         no  WORD  Internal   ABS    317  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_BKR                              526D         no  WORD  Internal   ABS    319  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_DTR                              526E         no  WORD  Internal   ABS    321  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM1_OISR                             526F         no  WORD  Internal   ABS    323  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CR1                              5300         no  WORD  Internal   ABS    328  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_IER                              5301         no  WORD  Internal   ABS    330  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_SR1                              5302         no  WORD  Internal   ABS    332  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_SR2                              5303         no  WORD  Internal   ABS    334  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_EGR                              5304         no  WORD  Internal   ABS    336  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCMR1                            5305         no  WORD  Internal   ABS    338  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCMR2                            5306         no  WORD  Internal   ABS    340  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCMR3                            5307         no  WORD  Internal   ABS    342  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCER1                            5308         no  WORD  Internal   ABS    344  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCER2                            5309         no  WORD  Internal   ABS    346  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CNTRH                            530A         no  WORD  Internal   ABS    348  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CNTRL                            530B         no  WORD  Internal   ABS    350  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_PSCR                             530C         no  WORD  Internal   ABS    352  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_ARRH                             530D         no  WORD  Internal   ABS    354  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_ARRL                             530E         no  WORD  Internal   ABS    356  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCR1H                            530F         no  WORD  Internal   ABS    358  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCR1L                            5310         no  WORD  Internal   ABS    360  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCR2H                            5311         no  WORD  Internal   ABS    362  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCR2L                            5312         no  WORD  Internal   ABS    364  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCR3H                            5313         no  WORD  Internal   ABS    366  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM2_CCR3L                            5314         no  WORD  Internal   ABS    368  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CR1                              5320         no  WORD  Internal   ABS    373  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_IER                              5321         no  WORD  Internal   ABS    375  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_SR1                              5322         no  WORD  Internal   ABS    377  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_SR2                              5323         no  WORD  Internal   ABS    379  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_EGR                              5324         no  WORD  Internal   ABS    381  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CCMR1                            5325         no  WORD  Internal   ABS    383  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CCMR2                            5326         no  WORD  Internal   ABS    385  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CCER1                            5327         no  WORD  Internal   ABS    387  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CNTRH                            5328         no  WORD  Internal   ABS    389  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CNTRL                            5329         no  WORD  Internal   ABS    391  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_PSCR                             532A         no  WORD  Internal   ABS    393  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_ARRH                             532B         no  WORD  Internal   ABS    395  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_ARRL                             532C         no  WORD  Internal   ABS    397  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CCR1H                            532D         no  WORD  Internal   ABS    399  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CCR1L                            532E         no  WORD  Internal   ABS    401  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CCR2H                            532F         no  WORD  Internal   ABS    403  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM3_CCR2L                            5330         no  WORD  Internal   ABS    405  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM4_CR1                              5340         no  WORD  Internal   ABS    410  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 56  Assembler
                                               e:\stm8s\electronic_scale\key.asm

TIM4_IER                              5341         no  WORD  Internal   ABS    412  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM4_SR                               5342         no  WORD  Internal   ABS    414  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM4_EGR                              5343         no  WORD  Internal   ABS    416  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM4_CNTR                             5344         no  WORD  Internal   ABS    418  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM4_PSCR                             5345         no  WORD  Internal   ABS    420  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TIM4_ARR                              5346         no  WORD  Internal   ABS    422  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
TriMul                                8A5C         no  WORD  Internal   ABS     15  private  text         0     0  e:\stm8s\electronic_scale\common.inc
TriDiv                                8B11         no  WORD  Internal   ABS     17  private  text         0     0  e:\stm8s\electronic_scale\common.inc
TypingCursorFlash                     8845         no  WORD  Internal   ABS    964  public   text         9     0  e:\stm8s\electronic_scale\key.inc
ThresholdInputHandle                  870A         no  WORD  Internal   ABS    648  public   text        93     0  -

UART2_SR                              5240         no  WORD  Internal   ABS    234  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_DR                              5241         no  WORD  Internal   ABS    236  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_BRR1                            5242         no  WORD  Internal   ABS    238  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_BRR2                            5243         no  WORD  Internal   ABS    240  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_CR1                             5244         no  WORD  Internal   ABS    242  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_CR2                             5245         no  WORD  Internal   ABS    244  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_CR3                             5246         no  WORD  Internal   ABS    246  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_CR4                             5247         no  WORD  Internal   ABS    248  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_CR5                             5248         no  WORD  Internal   ABS    250  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_CR6                             5249         no  WORD  Internal   ABS    252  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_GTR                             524A         no  WORD  Internal   ABS    254  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
UART2_PSCR                            524B         no  WORD  Internal   ABS    256  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc

WWDG_CR                               50D1         no  WORD  Internal   ABS    154  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
WWDG_WR                               50D2         no  WORD  Internal   ABS    156  private  text         0     0  c:\program files (x86)\stmicroelectronics\st_toolset\asm\include\STM8S105K.inc
WEIGHT_QUOTIENT                         8B         no  BYTE  Internal   ABS    211  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
WEIGHT_REMAINDER                        8D         no  BYTE  Internal   ABS    212  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc

ZERO_ADC                                7F         no  BYTE  Internal   ABS    192  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ZERO_ADC0                               82         no  BYTE  Internal   ABS    193  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ZERO_ADC1                               81         no  BYTE  Internal   ABS    194  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ZERO_ADC2                               80         no  BYTE  Internal   ABS    195  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc
ZERO_ADC3                               7F         no  BYTE  Internal   ABS    196  private  text         0     0  e:\stm8s\electronic_scale\globalvar.inc

col1_row1                             845A         no  WORD  Internal   ABS    246  private  text        17     0  -
col1_row2                             846B         no  WORD  Internal   ABS    253  private  text        17     0  -
col1_row3                             847C         no  WORD  Internal   ABS    260  private  text        17     0  -
col1_row4                             848D         no  WORD  Internal   ABS    267  private  text        17     0  -
col2_row1                             84A1         no  WORD  Internal   ABS    283  private  text        16     0  -
col2_row2                             84B1         no  WORD  Internal   ABS    290  private  text        16     0  -
col2_row3                             84C1         no  WORD  Internal   ABS    297  private  text        16     0  -
col2_row4                             84D1         no  WORD  Internal   ABS    304  private  text        17     0  -
col3_row1                             84E2         no  WORD  Internal   ABS    317  private  text        16     0  -
col3_row2                             84F2         no  WORD  Internal   ABS    324  private  text        16     0  -
col3_row3                             8502         no  WORD  Internal   ABS    331  private  text        16     0  -
col3_row4                             8512         no  WORD  Internal   ABS    338  private  text        16     0  -
col3_keyarray_done_jp                 8522         no  WORD  Internal   ABS    347  private  text         3     0  -
col23_keyarray_exit_jp                8525         no  WORD  Internal   ABS    351  private  text         3     0  -
cursorflash_menu_1                    884E         no  WORD  Internal   ABS    973  private  text        26     0  -
cursorflash_menu_3                    886D         no  WORD  Internal   ABS    991  private  text        13     0  -
cursorflash_exit                      887A         no  WORD  Internal   ABS    999  private  text         4     0  -

keyzero_handle_end                    83CD         no  WORD  Internal   ABS     73  private  text         6     0  -
keyarray_down_start                   8434         no  WORD  Internal   ABS    177  private  text         8     0  -
keyarray_handle_end                   8441         no  WORD  Internal   ABS    199  private  text         1     0  -
keyarray_determine_col_start          8445         no  WORD  Internal   ABS    233  private  text        18     0  -
STMicroelectronics list file postprocessor v1.01   (C)2009-2018   Thu Dec 20 01:10:50 2018
Page 57  Assembler
                                               e:\stm8s\electronic_scale\key.asm

keyarray_col3_jp                      8457         no  WORD  Internal   ABS    241  private  text         3     0  -
keyarray_col1                         845A         no  WORD  Internal   ABS    244  private  text        17     0  -
keyarray_exit_jp                      849E         no  WORD  Internal   ABS    276  private  text         3     0  -
keyarray_col2                         84A1         no  WORD  Internal   ABS    281  private  text        16     0  -
keyarray_col3                         84E2         no  WORD  Internal   ABS    315  private  text        16     0  -
keyarray_num                          8528         no  WORD  Internal   ABS    357  private  text         7     0  -
keyarray_num_menu_2                   852F         no  WORD  Internal   ABS    363  private  text         3     0  -
keyarray_num_start                    8532         no  WORD  Internal   ABS    369  private  text         8     0  -
keyarray_num_menu_1                   853A         no  WORD  Internal   ABS    381  private  text        13     0  -
keyarray_num_menu_3                   8547         no  WORD  Internal   ABS    393  private  text        12     0  -
keyarray_num_no_dot                   8553         no  WORD  Internal   ABS    402  private  text         6     0  -
keyarray_ptr_cur                      8559         no  WORD  Internal   ABS    410  private  text         7     0  -
keyarray_num_dot_exit_inc_jp          8560         no  WORD  Internal   ABS    422  private  text         3     0  -
keyarray_num_dot_exit_jp              8563         no  WORD  Internal   ABS    425  private  text         3     0  -
keyarray_dot                          8566         no  WORD  Internal   ABS    431  private  text        13     0  -
keyarray_dot_menu_2                   8573         no  WORD  Internal   ABS    440  private  text        51     0  -
keyarray_dot_menu_1                   85A6         no  WORD  Internal   ABS    460  private  text        26     0  -
keyarray_done                         85C0         no  WORD  Internal   ABS    489  private  text        19     0  -
keyarray_menu_to_3                    85D3         no  WORD  Internal   ABS    505  private  text        23     0  -
keyarray_menu_to_2                    85EA         no  WORD  Internal   ABS    511  private  text        23     0  -
keyarray_menu_to_1                    8601         no  WORD  Internal   ABS    517  private  text        23     0  -
keyarray_done_menu_1_3                8618         no  WORD  Internal   ABS    524  private  text        12     0  -
keyarray_scan_exit_inc                8624         no  WORD  Internal   ABS    537  private  text        16     0  -
keyarray_scan_exit                    8637         no  WORD  Internal   ABS    551  private  text        64     0  -
keyarray_scan_menu_2                  8677         no  WORD  Internal   ABS    568  private  text        47     0  -
keyarray_scan_menu_3                  86A6         no  WORD  Internal   ABS    573  private  text        45     0  -
keyarray_scan_menu_exit               86D3         no  WORD  Internal   ABS    578  private  text         4     0  -
keyarray_settle_menu_1                86DF         no  WORD  Internal   ABS    605  private  text        24     0  -
keyarray_settle_menu_3                86F7         no  WORD  Internal   ABS    623  private  text         8     0  -
keyarray_settle_exit                  86FF         no  WORD  Internal   ABS    629  private  text        11     0  -
keyarray_align_start                  8783         no  WORD  Internal   ABS    759  private  text         4     0  -
keyarray_dot_true                     8787         no  WORD  Internal   ABS    763  private  text        17     0  -
keyarray_dot_true_align_loop          8798         no  WORD  Internal   ABS    784  private  text        17     0  -
keyarray_dot_false                    87A9         no  WORD  Internal   ABS    802  private  text        16     0  -
keyarray_dot_false_align_loop         87B9         no  WORD  Internal   ABS    821  private  text        11     0  -
keyarray_display_menu_1               87D5         no  WORD  Internal   ABS    864  private  text        50     0  -
keyarray_display_menu_3               8807         no  WORD  Internal   ABS    896  private  text        58     0  -
keyarray_display_exit                 8841         no  WORD  Internal   ABS    943  private  text         4     0  -

moneydisplay_exit                     8981         no  WORD  Internal   ABS   1293  private  text         2     0  -

price_align_exit                      87C4         no  WORD  Internal   ABS    833  private  text         4     0  -

scan_exit_inc_menu_1                  8634         no  WORD  Internal   ABS    547  private  text         3     0  -
setcursor_ok                          8868         no  WORD  Internal   ABS    985  private  text         5     0  -

wait_keyup                            843C         no  WORD  Internal   ABS    184  private  text         5     0  -

zero_wait_keyup                       83CD         no  WORD  Internal   ABS     76  private  text         6     0  -


535 labels
No errors on assembly of 'e:\stm8s\electronic_scale\key.asm'